<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Wealth Management Platform</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e2e8f0; /* Light track for light mode */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e0; /* Slightly darker thumb */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        .dark ::-webkit-scrollbar-track {
            background: #2d3748; /* Darker track for dark mode */
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568; /* Even darker thumb */
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        /* Dark mode specific styles */
        .dark .bg-gray-100 { background-color: #1a202c; }
        .dark .text-gray-900 { color: #edf2f7; }
        .dark .bg-white { background-color: #2d3748; }
        .dark .text-gray-700 { color: #a0aec0; }
        .dark .text-gray-600 { color: #718096; }
        .dark .border-gray-200 { border-color: #4a5568; }
        .dark .shadow-md { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.12); }
        .dark .hover\:bg-blue-100:hover { background-color: #2a4365; }
        .dark .hover\:text-blue-700:hover { color: #63b3ed; }
        .dark .bg-blue-500 { background-color: #4299e1; }
        .dark .hover\:bg-blue-600:hover { background-color: #3182ce; }
        .dark .bg-gray-50 { background-color: #2d3748; }
        .dark .text-gray-500 { color: #a0aec0; }
        .dark .border-b { border-color: #4a5568; }
        .dark .text-gray-800 { color: #e2e8f0; }
        .dark .bg-gray-200 { background-color: #4a5568; }
        .dark .text-blue-600 { color: #63b3ed; }
        .dark .bg-blue-100 { background-color: #2a4365; }
        .dark .text-green-500 { color: #68d391; }
        .dark .text-red-500 { color: #fc8181; }
        .dark .text-yellow-500 { color: #f6ad55; }
        .dark .text-purple-500 { color: #b794f4; }
        .dark .bg-green-600 { background-color: #38a169; }
        .dark .bg-yellow-500 { background-color: #d69e2e; }
        .dark .bg-indigo-600 { background-color: #667eea; }
        .dark .hover\:text-blue-800:hover { color: #4299e1; }
        .dark .text-gray-300 { color: #d1d5db; } /* Added for better text contrast */
        .dark .text-gray-100 { color: #f3f4f6; } /* Added for better heading contrast */

        /* Chart.js specific dark mode adjustments */
        .dark canvas {
            background-color: #2d3748 !important; /* Ensure chart background adapts */
        }

        /* Tooltip styles */
        .tooltip-container {
            position: relative;
            display: inline-block;
        }

        .tooltip-text {
            visibility: hidden;
            width: 160px;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 10;
            bottom: 125%; /* Position above the icon */
            left: 50%;
            margin-left: -80px; /* Center the tooltip */
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%; /* At the bottom of the tooltip */
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(0, 0, 0, 0.7) transparent transparent transparent;
        }

        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .dark .tooltip-text {
            background-color: rgba(255, 255, 255, 0.2); /* Lighter background for dark mode tooltip */
            color: #fff;
        }

        .dark .tooltip-text::after {
            border-color: rgba(255, 255, 255, 0.2) transparent transparent transparent;
        }

        /* Product card icon styling */
        .product-action-icon {
            @apply text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400 transition-colors duration-200 cursor-pointer;
        }

        /* Adjusted product card padding to be more compact */
        .product-card {
            padding: 1rem; /* Reduced from p-4 to p-4 */
            height: 200px; /* Fixed height for compactness */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .product-card .content-area {
            flex-grow: 1; /* Allows content to take available space */
            overflow: hidden; /* Hide overflow description */
        }
        .product-card .actions-area {
            flex-shrink: 0; /* Prevents actions from shrinking */
            padding-top: 0.5rem; /* Small padding above buttons */
        }

        /* Filter button styling */
        .filter-button.active {
            @apply bg-blue-500 text-white dark:bg-blue-600 dark:text-gray-100;
        }
        .time-filter-button.active {
             @apply bg-blue-500 text-white dark:bg-blue-600 dark:text-gray-100;
        }

        /* Custom gauge chart styles for risk score */
        .gauge-chart-container {
            position: relative;
            width: 150px;
            height: 75px; /* Half circle */
            overflow: hidden;
            margin: 0 auto;
        }

        .gauge-chart-arc {
            position: absolute;
            top: 0;
            left: 0;
            width: 150px;
            height: 150px; /* Full circle */
            border-radius: 50%;
            border: 15px solid;
            border-color: #e2e8f0 #e2e8f0 #e2e8f0 #e2e8f0; /* Light mode default */
            box-sizing: border-box;
            transform: rotate(45deg); /* Align the start point */
        }

        .dark .gauge-chart-arc {
            border-color: #4a5568 #4a5568 #4a5568 #4a5568; /* Dark mode default */
        }

        .gauge-chart-value-arc {
            position: absolute;
            top: 0;
            left: 0;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 15px solid transparent;
            box-sizing: border-box;
            transform: rotate(45deg);
            transition: border-color 0.5s ease-in-out;
        }

        .gauge-chart-needle {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform-origin: bottom center;
            width: 2px;
            height: 65px; /* Length of the needle */
            background-color: #ef4444; /* Red color for needle */
            border-radius: 2px;
            transition: transform 0.5s ease-in-out;
            z-index: 1;
        }

        .gauge-chart-center-dot {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 10px;
            background-color: #ef4444;
            border-radius: 50%;
            z-index: 2;
        }

        .gauge-chart-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.875rem; /* text-xs */
            font-weight: 600; /* font-semibold */
            color: #374151; /* gray-700 */
            width: 100%;
            text-align: center;
        }

        .dark .gauge-chart-label {
            color: #d1d5db; /* gray-300 */
        }

        /* Modal specific styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .dark .modal-content {
            background-color: #2d3748;
            color: #edf2f7;
        }

        /* Notification panel styles */
        .notification-panel {
            position: absolute;
            top: 60px; /* Adjust based on header height */
            right: 0;
            width: 300px;
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 999;
            transform: translateX(100%);
            opacity: 0;
            visibility: hidden;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out, visibility 0.3s ease-out;
        }

        .notification-panel.open {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .dark .notification-panel {
            background-color: #2d3748;
            border-color: #4a5568;
        }
    </style>

<style>
  /* Light mode (Credence Analytics branding) */
  .light body {
    background-color: #ffffff;
    color: #333333;
  }

  .light .bg-white {
    background-color: #ffffff !important;
  }

  .light .text-gray-900,
  .light .text-gray-800,
  .light .text-gray-700,
  .light .text-gray-600,
  .light .text-gray-500 {
    color: #333333 !important;
  }

  .light .border,
  .light .border-gray-200,
  .light .border-b,
  .light .divide-gray-200 {
    border-color: #e0e0e0 !important;
  }

  .light .bg-blue-500 {
    background-color: #005bab !important;
  }

  .light .hover\:bg-blue-600:hover {
    background-color: #0074cc !important;
  }

  .light .hover\:text-blue-700:hover {
    color: #0074cc !important;
  }

  .light .text-blue-600 {
    color: #005bab !important;
  }

  .light .text-blue-500 {
    color: #0074cc !important;
  }

  .light .bg-gray-50,
  .light .bg-gray-100,
  .light .bg-gray-200 {
    background-color: #ffffff !important;
  }

  .light .bg-gray-800,
  .light .bg-gray-700,
  .light .bg-gray-600 {
    background-color: #ffffff !important;
  }

  .light canvas {
    background-color: #ffffff !important;
  }

  /* Focus/Hover (Accessibility) */
  .focus\:ring-blue-500:focus,
  .focus\:ring:focus {
    outline: 2px solid #005bab;
    outline-offset: 2px;
  }

  .hover\:bg-gray-300:hover {
    background-color: #e0e0e0 !important;
  }
</style>

<script>
  // Theme switcher logic
  document.addEventListener('DOMContentLoaded', function () {
    const toggle = document.getElementById('dark-mode-toggle');
    const html = document.documentElement;

    // Check local storage on load
    if (localStorage.getItem('theme') === 'dark') {
      html.classList.add('dark');
      toggle.checked = true;
    } else {
      html.classList.add('light');
      toggle.checked = false;
    }

    toggle.addEventListener('change', () => {
      if (toggle.checked) {
        html.classList.remove('light');
        html.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      } else {
        html.classList.remove('dark');
        html.classList.add('light');
        localStorage.setItem('theme', 'light');
      }
    });
  });
</script>

<link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css' rel='stylesheet' />
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js'></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('calendar');
    if (calendarEl) {
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'timeGridWeek',
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
        },
        events: [
          { title: 'Client Meeting: Al-Farsi', start: '2025-07-21T10:00:00', color: '#10b981' }, // Green
          { title: 'KYC Follow-up: Khan', start: '2025-07-22T14:30:00', color: '#10b981' }, // Green
          { title: 'Review Session: Mansour', start: '2025-07-25T11:00:00', color: '#10b981' }, // Green
          { title: 'Reminder: Process Al-Mansoori\'s transfer', start: '2025-07-24', display: 'background', color: '#ef4444' }, // Red
          { title: 'Corporate Event: Q3 Strategy Meeting', start: '2025-07-23T09:00:00', end: '2025-07-23T17:00:00', color: '#3b82f6' } // Blue
        ]
      });
      calendar.render();
    }
  });
</script>

</head>
<body class="bg-gray-100 flex h-screen text-gray-900 overflow-hidden transition-colors duration-300">
<aside class="w-64 bg-white dark:bg-gray-900 shadow-md flex flex-col p-6 rounded-r-lg transition-colors duration-300">
<div class="flex items-center mb-8">
<i class="fas fa-wallet text-blue-500 text-3xl mr-3"></i>
<h1 class="text-sm font-semibold text-gray-800 dark:text-gray-100">WealthPro</h1>
</div>
<nav class="flex-grow">
<ul class="space-y-3">
<li>
<a class="nav-link flex items-center p-3 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-colors duration-200" data-target="dashboard-view" href="#">
<i class="fas fa-chart-line mr-3 text-sm"></i>
<span>Dashboard</span>
</a>
</li>
<li>
<a class="nav-link flex items-center p-3 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-colors duration-200" data-target="clients-list-view" href="#">
<i class="fas fa-users mr-3 text-sm"></i>
<span>Clients</span>
</a>
</li>
<li>
<a class="nav-link flex items-center p-3 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-colors duration-200" data-target="calendar-view" href="#">
<i class="fas fa-calendar-alt mr-3 text-sm"></i>
<span>Calendar</span>
</a>
</li>
</ul>
</nav>
<div class="mt-auto pt-5 border-t border-gray-200 dark:border-gray-600">
<div class="flex items-center justify-between mb-3">
<span class="text-xs text-gray-600 dark:text-gray-400">Dark Mode</span>
<label class="relative inline-flex items-center cursor-pointer" for="dark-mode-toggle">
<input class="sr-only peer" id="dark-mode-toggle" type="checkbox"/>
<div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
</label>
</div>
<div class="flex items-center">
<i class="fas fa-user-circle text-gray-500 dark:text-gray-400 text-lg mr-2"></i>
<span class="text-gray-700 dark:text-gray-300 font-medium">Jane Doe, WM</span>
</div>
</div>
</aside>
<main class="flex-grow p-6 overflow-y-auto custom-scrollbar bg-gray-100 dark:bg-gray-800">
<header class="flex items-center justify-between pb-5 border-b border-gray-200 dark:border-gray-600 mb-6">
<h2 class="text-xl font-semibold text-gray-800 dark:text-gray-100" id="page-title">Dashboard</h2>
<div class="flex items-center space-x-3 ml-auto">
<div class="relative">
<button class="text-gray-700 dark:text-gray-300 text-lg hover:text-blue-500 dark:hover:text-blue-400 transition-colors duration-200 relative" id="notification-bell">
<i class="fas fa-bell"></i>
<span class="absolute top-0 right-0 block h-3 w-3 rounded-full ring-2 ring-white dark:ring-gray-800 bg-red-500 text-white text-xs flex items-center justify-center" id="notification-badge"></span>
</button>
<div class="notification-panel p-4 border border-gray-200 dark:border-gray-600" id="notification-panel">
<div class="flex justify-between items-center mb-3">
<h4 class="text-sm font-semibold text-gray-800 dark:text-gray-100">Notifications</h4>
<button class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" id="close-notification-panel">
<i class="fas fa-times"></i>
</button>
</div>
<ul class="space-y-3 text-xs">
<li class="flex items-start text-gray-700 dark:text-gray-300">
<i class="fas fa-money-bill-wave text-green-500 mr-2 mt-1"></i>
<span>New cash inflow of <strong class="text-green-600">$100K</strong> received for Client X.</span>
</li>
<li class="flex items-start text-gray-700 dark:text-gray-300">
<i class="fas fa-exclamation-triangle text-red-500 mr-2 mt-1"></i>
<span><strong class="text-red-600">Risk limit breach</strong> in Account #1294.</span>
</li>
<li class="flex items-start text-gray-700 dark:text-gray-300">
<i class="fas fa-calendar-check text-yellow-500 mr-2 mt-1"></i>
<span><strong class="text-yellow-600">KYC due for renewal</strong> in 5 days for Client Y.</span>
</li>
<li class="flex items-start text-gray-700 dark:text-gray-300">
<i class="fas fa-chart-line text-blue-500 mr-2 mt-1"></i>
<span>Client Z's portfolio performance updated.</span>
</li>
</ul>
</div>
</div>
<span class="text-gray-700 dark:text-gray-300 font-medium">Jane Doe, WM</span>
<button class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-sign-out-alt mr-2"></i>Logout
                </button>
</div>
</header>
<div class="content-view active-view" id="dashboard-view">
<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 xl:grid-cols-6 gap-4 mb-6">
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 flex flex-col transition-colors duration-300">
<div class="flex items-center justify-between mb-3">
<h3 class="text-xs font-medium text-gray-700 dark:text-gray-300">Total AUM</h3>
<i class="fas fa-dollar-sign text-blue-500 text-sm"></i>
</div>
<div class="flex-grow">
<p class="text-sm font-semibold text-gray-800 dark:text-gray-100">$1.25B</p>
<p class="text-xs text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i>3.2%</p>
</div>
<div class="tooltip-container">
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 flex flex-col transition-colors duration-300">
<div class="flex items-center justify-between mb-3">
<h3 class="text-xs font-medium text-gray-700 dark:text-gray-300">New Clients (YTD)</h3>
<i class="fas fa-user-plus text-green-500 text-sm"></i>
</div>
<div class="flex-grow">
<p class="text-sm font-semibold text-gray-800 dark:text-gray-100">45</p>
<p class="text-xs text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i>15%</p>
</div>
<div class="tooltip-container">
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 flex flex-col transition-colors duration-300">
<div class="flex items-center justify-between mb-3">
<h3 class="text-xs font-medium text-gray-700 dark:text-gray-300">Revenue (Q1)</h3>
<i class="fas fa-hand-holding-usd text-purple-500 text-sm"></i>
</div>
<div class="flex-grow">
<p class="text-sm font-semibold text-gray-800 dark:text-gray-100">$12.8M</p>
<p class="text-xs text-yellow-500 mt-1"><i class="fas fa-minus mr-1"></i>0.5%</p>
</div>
<div class="tooltip-container">
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 flex flex-col transition-colors duration-300 cursor-pointer" id="clients-attention-card">
<div class="flex items-center justify-between mb-3">
<h3 class="text-xs font-medium text-gray-700 dark:text-gray-300">Clients Attention</h3>
<i class="fas fa-exclamation-triangle text-red-500 text-sm"></i>
</div>
<div class="flex-grow">
<p class="text-sm font-semibold text-gray-800 dark:text-gray-100">7</p>
</div>
<div class="self-end tooltip-container">
<i class="fas fa-info-circle text-gray-400 text-xs cursor-help"></i>
<span class="tooltip-text">Number of clients requiring immediate attention or follow-up. Click to view.</span>
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 flex flex-col transition-colors duration-300">
<div class="flex items-center justify-between mb-3">
<h3 class="text-xs font-medium text-gray-700 dark:text-gray-300">Net AUM Growth</h3>
<i class="fas fa-chart-line text-indigo-500 text-sm"></i>
</div>
<div class="flex-grow">
<p class="text-sm font-semibold text-gray-800 dark:text-gray-100">$2.1M</p>
<p class="text-xs text-green-500 mt-1"><i class="fas fa-arrow-up mr-1"></i>+8.5%</p>
</div>
<div class="tooltip-container">
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 flex flex-col transition-colors duration-300">
<div class="flex items-center justify-between mb-3">
<h3 class="text-xs font-medium text-gray-700 dark:text-gray-300">Today's Cash Flow</h3>
<i class="fas fa-exchange-alt text-orange-500 text-sm"></i>
</div>
<div class="flex-grow">
<p class="text-sm font-semibold text-gray-800 dark:text-gray-100 flex items-center justify-between">
<span class="text-green-500"><i class="fas fa-arrow-up mr-1"></i>$50K In</span>
<span class="text-red-500"><i class="fas fa-arrow-down mr-1"></i>$15K Out</span>
</p>
</div>
<div class="tooltip-container">
</div>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-3">Portfolio Allocation</h3>
<div class="flex justify-end mb-3">
<select class="px-3 py-1 rounded-md border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 text-xs focus:outline-none focus:ring-2 focus:ring-blue-500" id="portfolio-allocation-filter">
<option value="none">Filter by...</option>
<option value="geography">Geography</option>
<option value="risk-categories">Risk Categories</option>
<option value="net-worth-tiers">Net Worth Tiers</option>
<option value="client-account-types">Client Account Types</option>
</select>
</div>
<div class="h-72">
<canvas id="portfolioAllocationChart"></canvas>
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-3">Investment Trends by Asset Class (Last 5 Years)</h3>
<div class="h-72">
<canvas id="assetClassPerformanceChart"></canvas>
</div>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<div class="flex justify-between items-center mb-4">
<h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100">Upcoming Schedule</h3>
<div class="flex rounded-full bg-gray-200 dark:bg-gray-600 p-1">
<button class="px-3 py-1 text-xs font-medium rounded-full bg-blue-500 text-white dark:bg-blue-600 dark:text-gray-100 transition-colors duration-200" id="activities-toggle">Activities</button>
<button class="px-3 py-1 text-xs font-medium rounded-full text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors duration-200" id="events-toggle">Events</button>
</div>
</div>
<ul class="space-y-3" id="activities-content">
<li class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-calendar-alt mr-2 text-blue-500"></i>Review with Mr. Al-Farsi</span>
<span class="text-gray-500 dark:text-gray-400">Tomorrow, 10:00 AM</span>
</li>
<li class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-phone mr-2 text-green-500"></i>Follow-up with Mrs. Khan</span>
<span class="text-gray-500 dark:text-gray-400">Wed, 2:00 PM</span>
</li>
<li class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-tasks mr-2 text-yellow-500"></i>Process Al-Mansoori's transfer</span>
<span class="text-gray-500 dark:text-gray-400">Due Friday</span>
</li>
</ul>
<ul class="space-y-3 hidden" id="events-content">
<li class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-birthday-cake mr-2 text-pink-500"></i>Birthday: Mr. Rashid Al-Ghaith</span>
<span class="text-gray-500 dark:text-gray-400">July 5th</span>
</li>
<li class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-gift mr-2 text-purple-500"></i>Anniversary: Mr. &amp; Mrs. Ibrahim</span>
<span class="text-500 dark:text-gray-400">July 12th</span>
</li>
<li class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-bell mr-2 text-blue-500"></i>Custom Event: Q3 Strategy Meeting</span>
<span class="text-gray-500 dark:text-gray-400">August 1st</span>
</li>
</ul>
</div>
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-4">Top Clients</h3>
<table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
<thead class="bg-gray-50 dark:bg-gray-800">
<tr>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400 cursor-pointer" data-sort-key="clientName" scope="col">Client <i class="fas fa-sort text-gray-400 ml-1"></i></th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400 cursor-pointer" data-sort-key="aum" scope="col">AUM <i class="fas fa-sort text-gray-400 ml-1"></i></th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400 cursor-pointer" data-sort-key="netFlows" scope="col">Net Flows <i class="fas fa-sort text-gray-400 ml-1"></i></th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400 cursor-pointer" data-sort-key="performance" scope="col">Perf. (%) <i class="fas fa-sort text-gray-400 ml-1"></i></th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400 cursor-pointer" data-sort-key="numAccounts" scope="col">No. of Client Accounts <i class="fas fa-sort text-gray-400 ml-1"></i></th>
</tr>
</thead>
<tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600" id="top-clients-table-body">
</tbody>
</table>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
    <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
        <h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-4">Top Cashflow Inflows for the Quarter</h3>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
                <thead class="bg-gray-50 dark:bg-gray-800">
                    <tr>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Client Name</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400"># Accounts</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Total AUM</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Amount Inflowed</th>
                    </tr>
                </thead>
                <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600">
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">A. Al-Farsi</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">4</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$150M</td>
                        <td class="px-4 py-3 whitespace-nowrap text-green-600">+$5.2M</td>
                    </tr>
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">H. Al-Ghamdi</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">1</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$45M</td>
                        <td class="px-4 py-3 whitespace-nowrap text-green-600">+$3.0M</td>
                    </tr>
                     <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">F. Al-Hammadi</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">2</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$80M</td>
                        <td class="px-4 py-3 whitespace-nowrap text-green-600">+$2.1M</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
        <h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-4">Top Cashflow Outflows for the Quarter</h3>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
                <thead class="bg-gray-50 dark:bg-gray-800">
                    <tr>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Client Name</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400"># Accounts</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Total AUM</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Amount Outflowed</th>
                    </tr>
                </thead>
                <tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600">
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">S. Mansour</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">3</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$95M</td>
                        <td class="px-4 py-3 whitespace-nowrap text-red-600">-$1.5M</td>
                    </tr>
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">Y. Al-Zahrani</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">2</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$30M</td>
                        <td class="px-4 py-3 whitespace-nowrap text-red-600">-$1.1M</td>
                    </tr>
                     <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">M. Al-Qahtani</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">2</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$120M</td>
                        <td class="px-4 py-3 whitespace-nowrap text-red-600">-$0.8M</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="modal-overlay hidden" id="clients-attention-modal">
<div class="modal-content dark:border dark:border-gray-600">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100">Clients Needing Attention</h3>
<button class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-sm" id="close-attention-modal">
<i class="fas fa-times"></i>
</button>
</div>
<ul class="space-y-3 text-sm text-gray-700 dark:text-gray-300">
<li class="p-2 bg-gray-50 dark:bg-gray-800 rounded-md">
<i class="fas fa-user-circle mr-2 text-blue-500"></i>Mr. John Doe - Low engagement (Last contact: 3 weeks ago)
                        </li>
<li class="p-2 bg-gray-50 dark:bg-gray-800 rounded-md">
<i class="fas fa-file-alt mr-2 text-yellow-500"></i>Mrs. Jane Smith - Pending annual review (Due: 2024-07-15)
                        </li>
<li class="p-2 bg-gray-50 dark:bg-gray-800 rounded-md">
<i class="fas fa-exclamation-circle mr-2 text-red-500"></i>Mr. Ali Hassan - Risk profile mismatch (Review required)
                        </li>
</ul>
</div>
</div>
</div>
<div class="content-view hidden" id="clients-list-view">
<h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-6">Your Clients</h3>
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<div class="mb-4 flex justify-between items-center">
<input class="pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 dark:border-gray-600 text-gray-900 dark:text-gray-200 text-xs" placeholder="Search clients..." type="text"/>
<button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-user-plus mr-2"></i>Add New Client
                    </button>
</div>
<div id="clients-table-container">
</div>
</div>
</div>
<div class="content-view hidden" id="calendar-view">
  <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-6">Calendar of Activities</h3>
  <div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
    <div id="calendar" class="text-sm text-gray-900 dark:text-gray-100">
    </div>
  </div>
</div>
<div class="content-view hidden" id="client-360-view">
<button class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-500 mb-4 flex items-center text-xs" onclick="showClientsList()">
<i class="fas fa-arrow-left mr-2"></i>Back to Clients
            </button>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 mb-6 flex items-center space-x-5 transition-colors duration-300" id="client-360-header">
<div class="w-20 h-20 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center text-gray-500 dark:text-gray-400 text-3xl">
<i class="fas fa-user"></i>
</div>
<div>
<h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-0.5" id="client-name-display">Client Name</h3>
<p class="text-sm text-gray-700 dark:text-gray-300" id="client-aum-display">AUM: $0</p>
<p class="text-xs text-gray-500 dark:text-gray-400" id="client-rm-display">RM: John Smith</p>
</div>
<div class="ml-auto flex space-x-3">
<button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-plus mr-2"></i>New Interaction
                    </button>
<button class="bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-file-alt mr-2"></i>Generate Report
                    </button>
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<div class="border-b border-gray-200 dark:border-gray-600 mb-5">
<nav aria-label="Tabs" class="-mb-px flex space-x-6">
<button class="tab-button whitespace-nowrap py-2.5 px-1 border-b-2 font-medium text-xs border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400 active-tab" data-tab="overview">Overview</button>
<button class="tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="portfolio">Portfolio</button>
<button class="tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="interactions">Interactions</button>
<button class="tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="goals">Goals &amp; Advisory</button>
<button class="tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="documents">Documents</button>
<button class="tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="compliance">Compliance &amp; Suitability</button>
</nav>
</div>
<div class="tab-content active-tab-content" id="overview-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Client Overview</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
<div>
<p class="text-gray-600 dark:text-gray-400 mb-1.5 text-xs"><strong class="text-gray-800 dark:text-gray-300">Email:</strong> <span id="client-email-display"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5 text-xs"><strong class="text-gray-800 dark:text-gray-300">Phone:</strong> <span id="client-phone-display"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5 text-xs"><strong class="text-gray-800 dark:text-gray-300">Risk Tolerance:</strong> <span id="client-risk-display"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5 text-xs"><strong class="text-gray-800 dark:text-gray-300">Financial Goals:</strong> <span id="client-goals-display"></span></p>
</div>
<div>
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Net Worth Summary</h5>
<p class="text-gray-600 dark:text-gray-400 mb-1 text-xs">Assets: $<span id="client-assets-display"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1 text-xs">Liabilities: $<span id="client-liabilities-display"></span></p>
<p class="text-gray-800 dark:text-gray-200 font-bold mt-2 text-sm">Net Worth: $<span id="client-networth-display"></span></p>
</div>
</div>
</div>
<div class="tab-content hidden" id="portfolio-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Portfolio Management</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
<div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Portfolio Performance (YTD)</h5>
<div class="h-72">
<canvas id="clientPortfolioPerformanceChart"></canvas>
</div>
</div>
<div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Cash Flow Trends</h5>
<div class="h-72">
<canvas id="clientCashFlowChart"></canvas>
</div>
</div>
</div>
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mt-2 mb-3">Current Holdings</h5>
<div class="overflow-x-auto">
<table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
<thead class="bg-gray-50 dark:bg-gray-800">
<tr>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Asset</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Type</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Value (USD)</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">P&amp;L</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Currency</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Account #</th>
</tr>
</thead>
<tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600">
<tr>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">Apple Inc.</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">Equity</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$1,500,000</td>
<td class="px-4 py-3 whitespace-nowrap text-green-600">+5.2%</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">USD</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">ACC101</td>
</tr>
<tr>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">Saudi Aramco</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">Equity</td>
<td class="px-4 py-3 whitespace-nowrap text-green-600">$800,000</td>
<td class="px-4 py-3 whitespace-nowrap text-green-600">+3.1%</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">SAR</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">ACC101</td>
</tr>
<tr>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">UAE Government Sukuk</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">Fixed Income (Sukuk)</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$2,000,000</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-600 dark:text-gray-400">--</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">AED</td>
<td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">ACC102</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="tab-content hidden" id="interactions-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Client Interaction History</h4>
<ul class="space-y-3">
<li class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<div class="flex items-center justify-between mb-2">
<span class="font-medium text-gray-800 dark:text-gray-200">Meeting: Portfolio Review</span>
<span class="text-xs text-gray-500 dark:text-gray-400">2024-06-20</span>
</div>
<p class="text-gray-600 dark:text-gray-400 text-xs">Discussed Q2 performance, agreed to increase exposure to alternatives. Generated performance report.</p>
</li>
<li class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<div class="flex items-center justify-between mb-2">
<span class="font-medium text-gray-800 dark:text-gray-200">Email: Market Update</span>
<span class="text-xs text-gray-500 dark:text-gray-400">2024-06-15</span>
</div>
<p class="text-gray-600 dark:text-gray-400 text-xs">Sent personalized market update focusing on energy sector trends in GCC.</p>
</li>
</ul>
</div>
<div class="tab-content hidden" id="goals-tab-content">
    <div class="flex justify-between items-center mb-4">
        <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100">Goals & Advisory</h4>
        <div class="flex rounded-full bg-gray-200 dark:bg-gray-600 p-1">
            <button class="px-3 py-1 text-xs font-medium rounded-full bg-blue-500 text-white dark:bg-blue-600 dark:text-gray-100 transition-colors duration-200" id="financial-goals-toggle">Financial Goals</button>
            <button class="px-3 py-1 text-xs font-medium rounded-full text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors duration-200" id="advisory-toggle">Advisory</button>
        </div>
    </div>
    <div id="financial-goals-content">
        <div class="space-y-4">
            <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
                <div class="flex items-center justify-between mb-2">
                    <h5 class="font-semibold text-gray-800 dark:text-gray-200">Retirement Planning</h5>
                    <span class="text-xs text-gray-500 dark:text-gray-400">Target: 2040</span>
                </div>
                <p class="text-gray-600 dark:text-gray-400 text-xs mb-2">Current Progress: 65% ($1.3M / $2M)</p>
                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5">
                    <div class="bg-green-600 h-2.5 rounded-full" style="width: 65%"></div>
                </div>
            </div>
            <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
                <div class="flex items-center justify-between mb-2">
                    <h5 class="font-semibold text-gray-800 dark:text-gray-200">Child's Education Fund</h5>
                    <span class="text-xs text-gray-500 dark:text-gray-400">Target: 2030</span>
                </div>
                <p class="text-gray-600 dark:text-gray-400 text-xs mb-2">Current Progress: 40% ($200K / $500K)</p>
                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5">
                    <div class="bg-yellow-500 h-2.5 rounded-full" style="width: 40%"></div>
                </div>
            </div>
        </div>
        <button class="mt-6 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs">
            <i class="fas fa-plus mr-2"></i>Add New Goal
        </button>
    </div>
    <div id="advisory-content" class="hidden">
        <div class="flex flex-col space-y-4 my-6">
            <div class="flex flex-wrap items-center gap-x-4 gap-y-2">
                <span class="text-gray-700 dark:text-gray-300 text-xs font-medium">Filter by Category:</span>
                <div class="flex rounded-full bg-gray-200 dark:bg-gray-800 p-0.5" id="advisory-category-filters">
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full active" data-category="All">All</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-category="Equities">Equities</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-category="Sukuk">Sukuk</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-category="Mutual Funds & ETFs">Mutual Funds & ETFs</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-category="Real Estate/REITs">Real Estate/REITs</button>
                </div>
                <div class="flex items-center gap-x-2" id="advisory-shariyah-filters">
                     <span class="text-gray-700 dark:text-gray-300 text-xs font-medium">Compliance:</span>
                     <button class="filter-button px-3 py-1 text-xs font-medium rounded-full active" data-shariyah="all">All</button>
                     <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-shariyah="yes">Shariyah</button>
                     <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-shariyah="no">Non-Shariyah</button>
                </div>
            </div>
            <div class="flex flex-wrap items-center gap-x-4 gap-y-2">
                <span class="text-gray-700 dark:text-gray-300 text-xs font-medium">Filter by Currency:</span>
                <div class="flex rounded-full bg-gray-200 dark:bg-gray-800 p-0.5" id="advisory-currency-filters">
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full active" data-currency="All">All</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-currency="SAR">SAR</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-currency="AED">AED</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-currency="USD">USD</button>
                    <button class="filter-button px-3 py-1 text-xs font-medium rounded-full" data-currency="KWD">KWD</button>
                </div>
                <div class="ml-auto flex items-center gap-2">
                    <label class="text-xs font-medium text-gray-700 dark:text-gray-300" for="sort-by-advisory">Sort by:</label>
                    <select class="px-3 py-1 rounded-md border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 text-xs focus:outline-none focus:ring-2 focus:ring-blue-500" id="sort-by-advisory">
                        <option value="none">Default</option>
                        <option value="return-desc">1-Year Return (High to Low)</option>
                        <option value="return-asc">1-Year Return (Low to High)</option>
                        <option value="risk-agg-con">Aggressive to Conservative</option>
                        <option value="risk-con-agg">Conservative to Aggressive</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4" id="advisory-product-cards-grid">
            </div>
    </div>
</div>
<div class="tab-content hidden" id="documents-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Document Vault</h4>
<ul class="space-y-3">
<li class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg flex items-center justify-between text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-file-pdf mr-2 text-red-500"></i>KYC Document - Passport.pdf</span>
<span class="text-xs text-gray-500 dark:text-gray-400">Uploaded: 2023-11-01</span>
<a class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-500 text-xs ml-auto" href="#">View</a>
</li>
<li class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg flex items-center justify-between text-gray-900 dark:text-gray-200 text-xs">
<span><i class="fas fa-file-excel mr-2 text-green-600"></i>Q1 2024 Portfolio Statement.xlsx</span>
<span class="text-xs text-gray-500 dark:text-gray-400">Generated: 2024-04-10</span>
<a class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-500 text-xs ml-auto" href="#">Download</a>
</li>
</ul>
<button class="mt-6 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-upload mr-2"></i>Upload Document
                    </button>
</div>
<div class="tab-content hidden" id="compliance-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Compliance &amp; Suitability Checks</h4>
<div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mb-4 text-xs">
<p class="text-gray-600 dark:text-gray-400">
<strong class="text-gray-800 dark:text-gray-200">Suitability Score:</strong> <span class="font-semibold text-green-600">92/100</span> (Well-aligned with risk profile)
                        </p>
<p class="text-gray-600 dark:text-gray-400 mt-2 text-xs">
<strong class="text-gray-800 dark:text-gray-200">Regulatory Status:</strong> All KYC up-to-date. DFSA &amp; FSRA guidelines adhered to.
                        </p>
</div>
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Audit Trail</h5>
<ul class="space-y-3">
<li class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<p class="text-gray-600 dark:text-gray-400 text-xs"><strong class="text-gray-800 dark:text-gray-200">2024-06-20 14:35:</strong> Portfolio rebalanced based on client's updated risk tolerance. (WM: Jane Doe)</p>
</li>
<li class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-gray-900 dark:text-gray-200 text-xs">
<p class="text-gray-600 dark:text-gray-400 text-xs"><strong class="text-gray-800 dark:text-gray-200">2024-05-01 09:10:</strong> KYC documents reviewed and verified. (RM: John Smith)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="content-view hidden" id="account-dashboard-view">
<button class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-500 mb-4 flex items-center text-xs" onclick="showClient360FromAccount()">
<i class="fas fa-arrow-left mr-2"></i>Back to Client Overview
            </button>
<div class="bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 mb-6 flex items-center space-x-5 transition-colors duration-300" id="account-dashboard-header">
<div class="w-20 h-20 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center text-gray-500 dark:text-gray-400 text-3xl">
<i class="fas fa-university"></i>
</div>
<div>
<h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100 mb-0.5" id="account-name-display">Account Name</h3>
<p class="text-sm text-gray-700 dark:text-gray-300" id="account-aum-display">AUM: $0</p>
<p class="text-xs text-gray-500 dark:text-gray-400" id="account-type-display">Type: Discretionary</p>
</div>
<div class="ml-auto flex space-x-3">
<button class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-chart-pie mr-2"></i>View Portfolio
                    </button>
<button class="bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-file-download mr-2"></i>Download Statement
                    </button>
</div>
</div>
<div class="bg-white dark:bg-gray-700 p-6 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 transition-colors duration-300">
<div class="border-b border-gray-200 dark:border-gray-600 mb-5">
<nav aria-label="Account Tabs" class="-mb-px flex space-x-6">
<button class="account-tab-button whitespace-nowrap py-2.5 px-1 border-b-2 font-medium text-xs border-blue-500 text-blue-600 dark:border-blue-400 dark:text-blue-400 active-tab" data-tab="portfolio-overview">Portfolio Overview</button>
<button class="account-tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="account-summary">Account Summary</button>
<button class="account-tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="risk-alerts">Risk &amp; Alerts</button>
<button class="account-tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="cash-liquidity">Cash &amp; Liquidity</button>
<button class="account-tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="recent-transactions">Recent Transactions</button>
<button class="account-tab-button whitespace-nowrap py-2.5 px-1 border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500 font-medium text-xs" data-tab="account-documents">Documents Tab</button>
</nav>
</div>
<div class="account-tab-content active-tab-content" id="portfolio-overview-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Portfolio Overview</h4>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6">
    <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
        <h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Portfolio Breakdown by Asset Class</h5>
        <div class="h-72">
            <canvas id="accountPortfolioBreakdownChart"></canvas>
        </div>
    </div>
     <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
        <div class="flex justify-between items-center mb-2">
             <h5 class="font-semibold text-gray-800 dark:text-gray-300">Change in Portfolio Value</h5>
             <div class="flex rounded-full bg-gray-200 dark:bg-gray-700 p-0.5" id="portfolio-value-time-filters">
                <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="1M">1M</button>
                <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="3M">3M</button>
                <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full active" data-period="YTD">YTD</button>
                <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="1Y">1Y</button>
                <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="3Y">3Y</button>
            </div>
        </div>
        <div class="h-64">
            <canvas id="accountPortfolioValueChangeChart"></canvas>
        </div>
    </div>
    <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
        <h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Allocation Movement Over Time</h5>
        <div class="h-72">
            <canvas id="accountAllocationMovementChart"></canvas>
        </div>
    </div>
    <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
        <h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Sector Allocation</h5>
        <div class="h-72">
            <canvas id="accountSectorAllocationChart"></canvas>
        </div>
    </div>
</div>

<h5 class="font-semibold text-gray-800 dark:text-gray-300 mt-2 mb-3">Top 5 Holdings</h5>
<div class="overflow-x-auto mb-6">
<table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
<thead class="bg-gray-50 dark:bg-gray-800">
<tr>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Holding</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Weight (%)</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Return (%)</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Currency</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Actions</th>
</tr>
</thead>
<tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600" id="top-holdings-table-body">
</tbody>
</table>
</div>
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mt-2 mb-3">Bottom 5 Holdings</h5>
<div class="overflow-x-auto">
<table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
<thead class="bg-gray-50 dark:bg-gray-800">
<tr>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Holding</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Weight (%)</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Return (%)</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Currency</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Actions</th>
</tr>
</thead>
<tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600" id="bottom-holdings-table-body">
</tbody>
</table>
</div>
</div>
<div class="account-tab-content hidden" id="account-summary-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Account Summary</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs">
<div>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Account Creation Date:</strong> <span id="summary-creation-date"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Mandate Type:</strong> <span id="summary-mandate-type"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Custodian Name:</strong> <span id="summary-custodian"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Currency Used:</strong> <span id="summary-currency"></span></p>
</div>
<div>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Compliance Status:</strong> <span class="font-semibold" id="summary-compliance-status"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Investment Guidelines:</strong> <span id="summary-investment-guidelines"></span></p>
</div>
</div>
</div>
<div class="account-tab-content hidden" id="risk-alerts-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Risk &amp; Alerts</h4>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6">
<div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg text-center">
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Current Risk Score</h5>
<div class="gauge-chart-container">
<div class="gauge-chart-arc" id="risk-gauge-arc"></div>
<div class="gauge-chart-value-arc" id="risk-gauge-value-arc"></div>
<div class="gauge-chart-needle" id="risk-gauge-needle"></div>
<div class="gauge-chart-center-dot"></div>
<div class="gauge-chart-label" id="risk-gauge-label"></div>
</div>
</div>
<div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-2">Historical Risk Score Trend</h5>
<div class="h-72">
<canvas id="accountHistoricalRiskChart"></canvas>
</div>
</div>
</div>
<h5 class="font-semibold text-gray-800 dark:text-gray-300 mb-3">Active Flags &amp; Alerts</h5>
<ul class="space-y-2 text-xs" id="risk-alerts-list">
</ul>
</div>
<div class="account-tab-content hidden" id="cash-liquidity-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Cash &amp; Liquidity</h4>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs mb-6">
<div>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Available Cash:</strong> <span class="font-bold" id="cash-available"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Pending Inflows:</strong> <span id="cash-inflows"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Pending Outflows:</strong> <span id="cash-outflows"></span></p>
</div>
<div>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Recommended Cash Buffer:</strong> <span id="cash-recommended"></span></p>
<p class="text-gray-600 dark:text-gray-400 mb-1.5"><strong class="text-gray-800 dark:text-gray-300">Upcoming Redemptions/Maturities:</strong> <span id="cash-redemptions"></span></p>
</div>
</div>
<div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-lg">
    <div class="flex flex-wrap justify-between items-center mb-4">
        <h5 class="font-semibold text-gray-800 dark:text-gray-300">Upcoming Inflows</h5>
        <div class="flex rounded-full bg-gray-200 dark:bg-gray-700 p-0.5" id="cash-inflows-time-filters">
            <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full active" data-period="1W">1W</button>
            <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="1M">1M</button>
            <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="3M">3M</button>
            <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="YTD">YTD</button>
            <button class="time-filter-button px-2 py-0.5 text-xs font-medium rounded-full" data-period="1Y">1Y</button>
        </div>
    </div>
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
            <thead class="bg-gray-100 dark:bg-gray-700">
                <tr>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Instrument</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Type</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Amount</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Currency</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400">Expected Date</th>
                </tr>
            </thead>
            <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-600" id="upcoming-inflows-table-body">
                </tbody>
        </table>
    </div>
</div>
</div>
<div class="account-tab-content hidden" id="recent-transactions-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Recent Transactions</h4>
<div class="overflow-x-auto">
<table class="min-w-full divide-y divide-gray-200 dark:divide-gray-600 text-xs">
<thead class="bg-gray-50 dark:bg-gray-800">
<tr>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Date</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Security</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Type</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Quantity</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Value</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Currency</th>
<th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400" scope="col">Status</th>
</tr>
</thead>
<tbody class="bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600" id="transactions-table-body">
</tbody>
</table>
</div>
</div>
<div class="account-tab-content hidden" id="account-documents-tab-content">
<h4 class="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4">Account Document Vault</h4>
<ul class="space-y-3" id="account-documents-list">
</ul>
<button class="mt-6 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs">
<i class="fas fa-upload mr-2"></i>Upload Document
                    </button>
</div>
</div>
</div>
</main>
<script>
        // Dummy Client Data
        const clients = {
            client1: {
                id: "client1",
                name: "Mr. Ahmed Al-Farsi",
                aum: "150,000,000",
                rm: "Jane Doe",
                email: "ahmed.alfarsi@example.com",
                phone: "+971 50 123 4567",
                risk: "Aggressive",
                goals: "Wealth Growth, Real Estate Investment",
                assets: "160,000,000",
                liabilities: "10,000,000",
                netWorth: "150,000,000",
                accounts: [
                    {
                        accountId: "acc101",
                        accountType: "Discretionary Account",
                        riskScore: 85, // out of 100
                        aum: "75,000,000",
                        lastActivity: "2024-06-28",
                        portfolioBreakdown: {
                            labels: ['Equities', 'Fixed Income', 'Commodities', 'Cash'],
                            data: [50, 25, 15, 10]
                        },
                        portfolioValueChange: {
                            '1M': [74100000, 74500000, 74800000, 75000000],
                            '3M': [72000000, 72500000, 73000000, 73200000, 73800000, 74000000, 74100000, 74500000, 74800000, 74900000, 74950000, 75000000],
                            'YTD': [70000000, 70500000, 71000000, 71200000, 71800000, 72000000, 72500000, 73000000, 73200000, 73800000, 74000000, 75000000],
                            '1Y': [68000000, 68500000, 69000000, 70000000, 70500000, 71000000, 71200000, 71800000, 72000000, 72500000, 73000000, 75000000],
                            '3Y': [60000000, 62000000, 63000000, 65000000, 66000000, 68000000, 68500000, 69000000, 70000000, 72000000, 73000000, 75000000]
                        },
                        currentAllocation: [45, 30, 15, 10],
                        strategicAllocation: [40, 35, 15, 10],
                        allocationMovement: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            equity: [40, 42, 43, 45, 46, 48],
                            fixedIncome: [35, 33, 32, 30, 29, 27]
                        },
                        sectorAllocation: {
                            labels: ['Financials', 'Energy', 'Technology', 'Healthcare', 'Industrials', 'Utilities'],
                            data: [25, 20, 15, 12, 10, 8]
                        },
                        topHoldings: [
                            { name: "Saudi Aramco", weight: 8.5, return: 3.1, currency: "SAR" },
                            { name: "Apple Inc.", weight: 7.2, return: 5.2, currency: "USD" },
                            { name: "UAE Government Sukuk", weight: 6.0, return: 0.8, currency: "AED" },
                            { name: "Microsoft Corp.", weight: 5.8, return: 4.5, currency: "USD" },
                            { name: "ADNOC Distribution", weight: 5.0, return: 2.9, currency: "AED" }
                        ],
                        bottomHoldings: [
                            { name: "Small Cap Tech Fund", weight: 1.2, return: -2.5, currency: "USD" },
                            { name: "Emerging Market Bond", weight: 1.5, return: -1.0, currency: "USD" },
                            { name: "Local Real Estate Trust", weight: 1.8, return: 0.1, currency: "AED" },
                            { name: "Gold ETF", weight: 2.0, return: -0.5, currency: "USD" },
                            { name: "Biotech Startup", weight: 0.5, return: -5.0, currency: "USD" }
                        ],
                        summary: {
                            creationDate: "2020-01-15",
                            mandateType: "Discretionary",
                            custodianName: "ABC Custodian Bank",
                            complianceStatus: "Compliant (No Flags)",
                            investmentGuidelines: "Focus on Shari'ah-compliant assets, max 10% in illiquid assets.",
                            currencyUsed: "USD, AED, SAR"
                        },
                        historicalRiskScore: [80, 82, 85, 83, 86, 85],
                        alerts: [
                            { type: "Over-concentration", description: "Equity exposure exceeds 50% limit by 5%", severity: "High" },
                            { type: "Limit Breaches", description: "Single stock exposure (Saudi Aramco) at 8.5%, nearing 10% limit.", severity: "Medium" }
                        ],
                        cashLiquidity: {
                            availableCash: "5,000,000",
                            pendingInflows: "1,200,000 (Dividends, Bond Maturity)",
                            pendingOutflows: "300,000 (Management Fees, Planned Investment)",
                            recommendedCashBuffer: "2,000,000",
                            upcomingRedemptions: "UAE Sukuk (AED 500,000) - 2024-07-30",
                            upcomingInflows: [
                                { instrument: "Apple Inc.", type: "Dividend", amount: 12000, currency: "USD", date: "2025-07-25" },
                                { instrument: "UAE Gov Sukuk '28", type: "Coupon", amount: 25000, currency: "AED", date: "2025-08-01" },
                                { instrument: "KSA FD", type: "Maturity", amount: 150000, currency: "SAR", date: "2025-08-15" }
                            ]
                        },
                        transactions: [
                            { date: "2024-06-25", security: "Apple Inc.", type: "Buy", quantity: 100, value: "18,000", currency: "USD", status: "Completed" },
                            { date: "2024-06-20", security: "Saudi Aramco", type: "Sell", quantity: 500, value: "19,000", currency: "SAR", status: "Completed" },
                            { date: "2024-06-18", security: "UAE Government Sukuk", type: "Buy", quantity: 2, value: "200,000", currency: "AED", status: "Completed" },
                            { date: "2024-06-10", security: "Microsoft Corp.", type: "Buy", quantity: 50, value: "10,000", currency: "USD", status: "Pending" }
                        ],
                        documents: [
                            { name: "Account Opening Form.pdf", date: "2020-01-10", type: "KYC", action: "View" },
                            { name: "Discretionary Mandate.pdf", date: "2020-01-15", type: "Mandate Docs", action: "View" },
                            { name: "Q1 2024 Statement.xlsx", date: "2024-04-05", type: "Statements", action: "Download" }
                        ]
                    },
                    {
                        accountId: "acc102",
                        accountType: "Non-Discretionary Account",
                        riskScore: 60,
                        aum: "40,000,000",
                        lastActivity: "2024-06-20",
                        portfolioBreakdown: {
                            labels: ['Fixed Income', 'Equities', 'Cash'],
                            data: [50, 30, 20]
                        },
                        portfolioValueChange: {
                           '1M': [39800000, 39900000, 39950000, 40000000],
                            '3M': [39000000, 39200000, 39300000, 39500000, 39600000, 39700000, 39800000, 39900000, 39950000, 39980000, 39990000, 40000000],
                            'YTD': [38000000, 38200000, 38500000, 38800000, 39000000, 39200000, 39300000, 39500000, 39600000, 39800000, 39900000, 40000000],
                            '1Y': [37000000, 37500000, 38000000, 38200000, 38500000, 38800000, 39000000, 39200000, 39300000, 39500000, 39800000, 40000000],
                            '3Y': [35000000, 35500000, 36000000, 36500000, 37000000, 37500000, 38000000, 38500000, 39000000, 39200000, 39500000, 40000000]
                        },
                        currentAllocation: [50, 30, 20],
                        strategicAllocation: [55, 25, 20],
                        allocationMovement: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            equity: [30, 31, 30, 32, 33, 34],
                            fixedIncome: [55, 53, 54, 52, 51, 50]
                        },
                        sectorAllocation: {
                            labels: ['Government Bonds', 'Corporate Bonds', 'Utilities', 'Consumer Staples'],
                            data: [40, 30, 15, 10]
                        },
                        topHoldings: [
                            { name: "KSA Government Bond", weight: 10.0, return: 1.2, currency: "SAR" },
                            { name: "Etihad Airways Sukuk", weight: 8.0, return: 2.5, currency: "AED" },
                            { name: "Nestle SA", weight: 5.0, return: 1.5, currency: "CHF" },
                            { name: "Saudi Electric Co.", weight: 4.5, return: 0.9, currency: "SAR" },
                            { name: "Vodafone Group Plc", weight: 3.8, return: 0.7, currency: "GBP" }
                        ],
                        bottomHoldings: [
                            { name: "Small Cap Pharma", weight: 0.8, return: -3.0, currency: "USD" },
                            { name: "Emerging Market Equity", weight: 1.0, return: -1.5, currency: "USD" },
                            { name: "High Yield Bond Fund", weight: 1.2, return: -0.8, currency: "USD" },
                            { name: "Gold Futures", weight: 0.5, return: -2.0, currency: "USD" },
                            { name: "Local Bank Stock", weight: 1.5, return: 0.2, currency: "AED" }
                        ],
                        summary: {
                            creationDate: "2021-03-01",
                            mandateType: "Non-Discretionary",
                            custodianName: "XYZ Custody",
                            complianceStatus: "Compliant",
                            investmentGuidelines: "Client-directed investments, no speculative assets.",
                            currencyUsed: "SAR, AED"
                        },
                        historicalRiskScore: [65, 62, 60, 61, 58, 60],
                        alerts: [
                            { type: "Information", description: "Client recently requested a review of fixed income options.", severity: "Low" }
                        ],
                         cashLiquidity: {
                            availableCash: "2,500,000",
                            pendingInflows: "500,000 (Bond Coupons)",
                            pendingOutflows: "100,000 (Household Expenses)",
                            recommendedCashBuffer: "1,000,000",
                            upcomingRedemptions: "KSA Bond (SAR 1,000,000) - 2025-01-15",
                            upcomingInflows: []
                        },
                        transactions: [
                            { date: "2024-06-15", security: "KSA Government Bond", type: "Buy", quantity: 5, value: "500,000", currency: "SAR", status: "Completed" },
                            { date: "2024-06-01", security: "Etihad Airways Sukuk", type: "Sell", quantity: 10, value: "100,000", currency: "AED", status: "Completed" }
                        ],
                        documents: [
                            { name: "Non-Discretionary Agreement.pdf", date: "2021-02-20", type: "Mandate Docs", action: "View" },
                            { name: "Annual Statement 2023.pdf", date: "2024-01-10", type: "Statements", action: "Download" }
                        ]
                    },
                    {
                        accountId: "acc103",
                        accountType: "Joint Account with Spouse",
                        riskScore: 50,
                        aum: "20,000,000",
                        lastActivity: "2024-06-10",
                        portfolioBreakdown: {
                            labels: ['Fixed Income', 'Real Estate', 'Cash'],
                            data: [60, 25, 15]
                        },
                         portfolioValueChange: {
                            '1M': [19800000, 19900000, 19950000, 20000000],
                            '3M': [19000000, 19200000, 19300000, 19500000, 19600000, 19700000, 19800000, 19900000, 19950000, 19980000, 19990000, 20000000],
                            'YTD': [18000000, 18200000, 18500000, 18800000, 19000000, 19200000, 19300000, 19500000, 19600000, 19800000, 19900000, 20000000],
                            '1Y': [17000000, 17500000, 18000000, 18200000, 18500000, 18800000, 19000000, 19200000, 19300000, 19500000, 19800000, 20000000],
                            '3Y': [15000000, 15500000, 16000000, 16500000, 17000000, 17500000, 18000000, 18500000, 19000000, 19200000, 19500000, 20000000]
                        },
                        currentAllocation: [60, 25, 15],
                        strategicAllocation: [60, 20, 20],
                        allocationMovement: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            equity: [10, 10, 10, 10, 10, 10],
                            fixedIncome: [60, 60, 60, 60, 60, 60]
                        },
                        sectorAllocation: {
                            labels: ['Real Estate', 'Government Bonds', 'Corporate Bonds'],
                            data: [25, 40, 20]
                        },
                        topHoldings: [
                            { name: "UAE Property REIT", weight: 15.0, return: 3.0, currency: "AED" },
                            { name: "Saudi Government Sukuk", weight: 12.0, return: 1.0, currency: "SAR" },
                            { name: "Dubai Fixed Income Fund", weight: 10.0, return: 1.8, currency: "AED" }
                        ],
                        bottomHoldings: [
                            { name: "Small Cap Equity", weight: 0.5, return: -0.5, currency: "USD" }
                        ],
                        summary: {
                            creationDate: "2019-08-01",
                            mandateType: "Non-Discretionary (Joint)",
                            custodianName: "First Gulf Custody",
                            complianceStatus: "Compliant",
                            investmentGuidelines: "Conservative growth, income generation, focus on real estate.",
                            currencyUsed: "AED"
                        },
                        historicalRiskScore: [55, 52, 50, 51, 48, 50],
                        alerts: [],
                        cashLiquidity: {
                            availableCash: "1,500,000",
                            pendingInflows: "200,000 (Rental Income)",
                            pendingOutflows: "50,000 (Property Maintenance)",
                            recommendedCashBuffer: "500,000",
                            upcomingRedemptions: "Dubai REIT (AED 1,000,000) - 2024-12-31",
                             upcomingInflows: []
                        },
                        transactions: [
                            { date: "2024-06-05", security: "UAE Property REIT", type: "Buy", quantity: 1000, value: "100,000", currency: "AED", status: "Completed" }
                        ],
                        documents: [
                            { name: "Joint Account Agreement.pdf", date: "2019-07-25", type: "Mandate Docs", action: "View" },
                            { name: "Property Deed.pdf", date: "2019-08-01", type: "Other", action: "Download" }
                        ]
                    },
                    {
                        accountId: "acc104",
                        accountType: "Joint Account with Children",
                        riskScore: 70,
                        aum: "15,000,000",
                        lastActivity: "2024-06-25",
                        portfolioBreakdown: {
                            labels: ['Equities', 'Mutual Funds', 'Cash'],
                            data: [60, 30, 10]
                        },
                         portfolioValueChange: {
                            '1M': [14800000, 14900000, 14950000, 15000000],
                            '3M': [14000000, 14200000, 14300000, 14500000, 14600000, 14700000, 14800000, 14900000, 14950000, 14980000, 14990000, 15000000],
                            'YTD': [13000000, 13200000, 13500000, 13800000, 14000000, 14200000, 14300000, 14500000, 14600000, 14800000, 14900000, 15000000],
                            '1Y': [12000000, 12500000, 13000000, 13200000, 13500000, 13800000, 14000000, 14200000, 14300000, 14500000, 14800000, 15000000],
                            '3Y': [10000000, 10500000, 11000000, 11500000, 12000000, 12500000, 13000000, 13500000, 14000000, 14200000, 14500000, 15000000]
                        },
                        currentAllocation: [60, 30, 10],
                        strategicAllocation: [65, 25, 10],
                        allocationMovement: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            equity: [55, 58, 60, 62, 60, 61],
                            mutualFunds: [35, 32, 30, 28, 30, 29]
                        },
                        sectorAllocation: {
                            labels: ['Global Tech', 'Healthcare', 'Education Funds', 'Consumer Discretionary'],
                            data: [30, 20, 25, 15]
                        },
                        topHoldings: [
                            { name: "Global Islamic Tech Fund", weight: 10.0, return: 5.0, currency: "USD" },
                            { name: "Children's Education Mutual Fund", weight: 8.0, return: 3.5, currency: "USD" },
                            { name: "Alphabet Inc.", weight: 7.0, return: 6.0, currency: "USD" }
                        ],
                        bottomHoldings: [
                            { name: "Local SME Equity", weight: 1.0, return: -1.0, currency: "AED" }
                        ],
                        summary: {
                            creationDate: "2022-05-01",
                            mandateType: "Discretionary (Joint)",
                            custodianName: "Global Trust Bank",
                            complianceStatus: "Compliant",
                            investmentGuidelines: "Long-term growth for education, moderate risk.",
                            currencyUsed: "USD"
                        },
                        historicalRiskScore: [68, 70, 69, 71, 70, 70],
                        alerts: [],
                        cashLiquidity: {
                            availableCash: "1,000,000",
                            pendingInflows: "100,000 (Parent Contribution)",
                            pendingOutflows: "50,000 (School Fees)",
                            recommendedCashBuffer: "200,000",
                            upcomingRedemptions: "None",
                            upcomingInflows: []
                        },
                        transactions: [
                            { date: "2024-06-20", security: "Global Islamic Tech Fund", type: "Buy", quantity: 50, value: "5,000", currency: "USD", status: "Completed" }
                        ],
                        documents: [
                            { name: "Joint Account for Minors.pdf", date: "2022-04-20", type: "Mandate Docs", action: "View" },
                            { name: "Education Savings Plan.pdf", date: "2022-05-01", type: "Other", action: "Download" }
                        ]
                    }
                ]
            },
            client2: {
                id: "client2",
                name: "Mrs. Aisha Khan",
                aum: "75,000,000",
                rm: "Jane Doe",
                email: "aisha.khan@example.com",
                phone: "+966 55 987 6543",
                risk: "Moderate",
                goals: "Retirement Planning, Child's Education",
                assets: "80,000,000",
                liabilities: "5,000,000",
                netWorth: "75,000,000",
                accounts: [
                    {
                        accountId: "acc201",
                        accountType: "Retirement Savings Account",
                        riskScore: 55,
                        aum: "60,000,000",
                        lastActivity: "2024-06-29",
                        portfolioBreakdown: {
                            labels: ['Fixed Income', 'Equities', 'Real Estate', 'Cash'],
                            data: [40, 35, 15, 10]
                        },
                        portfolioValueChange: {
                            '1M': [59800000, 59900000, 59950000, 60000000],
                            '3M': [59000000, 59200000, 59300000, 59500000, 59600000, 59700000, 59800000, 59900000, 59950000, 59980000, 59990000, 60000000],
                            'YTD': [58000000, 58200000, 58500000, 58800000, 59000000, 59200000, 59300000, 59500000, 59600000, 59800000, 59900000, 60000000],
                            '1Y': [57000000, 57500000, 58000000, 58200000, 58500000, 58800000, 59000000, 59200000, 59300000, 59500000, 59800000, 60000000],
                            '3Y': [55000000, 55500000, 56000000, 56500000, 57000000, 57500000, 58000000, 58500000, 59000000, 59200000, 59500000, 60000000]
                        },
                        currentAllocation: [40, 35, 15, 10],
                        strategicAllocation: [45, 30, 15, 10],
                        allocationMovement: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            equity: [30, 32, 33, 35, 34, 36],
                            fixedIncome: [45, 43, 42, 40, 41, 39]
                        },
                        sectorAllocation: {
                            labels: ['Utilities', 'Healthcare', 'Consumer Staples', 'Financials'],
                            data: [20, 25, 18, 15]
                        },
                        topHoldings: [
                            { name: "KSA Retirement Sukuk", weight: 9.0, return: 1.5, currency: "SAR" },
                            { name: "Global Dividend Equity Fund", weight: 7.5, return: 4.0, currency: "USD" },
                            { name: "Saudi Real Estate Income", weight: 6.0, return: 2.0, currency: "SAR" }
                        ],
                        bottomHoldings: [
                            { name: "Emerging Market Equity Fund", weight: 1.0, return: -1.2, currency: "USD" }
                        ],
                        summary: {
                            creationDate: "2018-07-01",
                            mandateType: "Discretionary",
                            custodianName: "KSA Wealth Custody",
                            complianceStatus: "Compliant",
                            investmentGuidelines: "Long-term retirement growth, moderate risk, income focus.",
                            currencyUsed: "SAR"
                        },
                        historicalRiskScore: [50, 52, 55, 53, 56, 55],
                        alerts: [],
                        cashLiquidity: {
                            availableCash: "3,000,000",
                            pendingInflows: "800,000 (Pension Contributions)",
                            pendingOutflows: "150,000 (Scheduled Withdrawals)",
                            recommendedCashBuffer: "1,500,000",
                            upcomingRedemptions: "None",
                            upcomingInflows: []
                        },
                        transactions: [
                            { date: "2024-06-20", security: "Global Dividend Equity Fund", type: "Buy", quantity: 200, value: "20,000", currency: "USD", status: "Completed" },
                            { date: "2024-06-10", security: "KSA Retirement Sukuk", type: "Buy", quantity: 10, value: "1,000,000", currency: "SAR", status: "Completed" }
                        ],
                        documents: [
                            { name: "Retirement Plan Agreement.pdf", date: "2018-06-25", type: "Mandate Docs", action: "View" },
                            { name: "Q2 2024 Statement.pdf", date: "2024-07-01", type: "Statements", action: "Download" }
                        ]
                    },
                    {
                        accountId: "acc202",
                        accountType: "Education Savings Account",
                        riskScore: 65,
                        aum: "15,000,000",
                        lastActivity: "2024-06-27",
                        portfolioBreakdown: {
                            labels: ['Equities', 'Mutual Funds', 'Cash'],
                            data: [55, 30, 15]
                        },
                        portfolioValueChange: {
                            '1M': [14800000, 14900000, 14950000, 15000000],
                            '3M': [14000000, 14200000, 14300000, 14500000, 14600000, 14700000, 14800000, 14900000, 14950000, 14980000, 14990000, 15000000],
                            'YTD': [13000000, 13200000, 13500000, 13800000, 14000000, 14200000, 14300000, 14500000, 14600000, 14800000, 14900000, 15000000],
                            '1Y': [12000000, 12500000, 13000000, 13200000, 13500000, 13800000, 14000000, 14200000, 14300000, 14500000, 14800000, 15000000],
                            '3Y': [10000000, 10500000, 11000000, 11500000, 12000000, 12500000, 13000000, 13500000, 14000000, 14200000, 14500000, 15000000]
                        },
                        currentAllocation: [55, 30, 15],
                        strategicAllocation: [60, 25, 15],
                        allocationMovement: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                            equity: [50, 52, 53, 55, 54, 56],
                            mutualFunds: [35, 33, 32, 30, 31, 29]
                        },
                        sectorAllocation: {
                            labels: ['Education Services', 'Technology', 'Healthcare', 'Consumer Discretionary'],
                            data: [30, 20, 15, 10]
                        },
                        topHoldings: [
                            { name: "Global Education Fund", weight: 12.0, return: 4.5, currency: "USD" },
                            { name: "Tech Growth ETF", weight: 9.0, return: 6.0, currency: "USD" },
                            { name: "Saudi Telecom Co.", weight: 7.0, return: 2.5, currency: "SAR" }
                        ],
                        bottomHoldings: [
                            { name: "Local Small Cap", weight: 0.7, return: -0.8, currency: "SAR" }
                        ],
                        summary: {
                            creationDate: "2020-09-10",
                            mandateType: "Discretionary",
                            custodianName: "KSA Wealth Custody",
                            complianceStatus: "Compliant",
                            investmentGuidelines: "Aggressive growth for child's university, long horizon.",
                            currencyUsed: "USD, SAR"
                        },
                        historicalRiskScore: [60, 62, 65, 63, 66, 65],
                        alerts: [],
                        cashLiquidity: {
                            availableCash: "1,000,000",
                            pendingInflows: "100,000 (Monthly Contribution)",
                            pendingOutflows: "0",
                            recommendedCashBuffer: "200,000",
                            upcomingRedemptions: "None",
                            upcomingInflows: []
                        },
                        transactions: [
                            { date: "2024-06-25", security: "Global Education Fund", type: "Buy", quantity: 100, value: "10,000", currency: "USD", status: "Completed" }
                        ],
                        documents: [
                            { name: "Education Savings Plan.pdf", date: "2020-09-01", type: "Mandate Docs", action: "View" },
                            { name: "Child's Birth Certificate.pdf", date: "2020-09-01", type: "KYC", action: "View" }
                        ]
                    }
                ]
            }
        };

        let currentClientId = null;
        let currentAccountId = null;

        // Chart instances holder
        let portfolioAllocationChart, assetClassPerformanceChart, cumulativeFlowsChart, shariahProductPerformanceChart,
            clientPortfolioPerformanceChart, clientCashFlowChart,
            accountPortfolioBreakdownChart, accountPortfolioValueChangeChart, accountAllocationComparisonChart,
            accountAllocationMovementChart, accountSectorAllocationChart, accountHistoricalRiskChart;

        // Dummy data for Top Clients on Dashboard
        const dashboardTopClientsData = [
            { clientName: "A. Al-Farsi", aum: 150000000, netFlows: 5000000, performance: 12.5, numAccounts: 4 },
            { clientName: "M. Al-Qahtani", aum: 120000000, netFlows: 3000000, performance: 10.2, numAccounts: 2 },
            { clientName: "S. Mansour", aum: 95000000, netFlows: -1000000, performance: 8.8, numAccounts: 3 },
            { clientName: "F. Al-Hammadi", aum: 80000000, netFlows: 2000000, performance: 9.5, numAccounts: 2 },
            { clientName: "N. Al-Dossari", aum: 70000000, netFlows: 1500000, performance: 11.0, numAccounts: 1 }
        ];

        let currentTopClientsSortKey = 'clientName';
        let currentTopClientsSortDirection = 'asc'; // 'asc' or 'desc'

        // Function to destroy existing chart instances
        function destroyCharts() {
            if (portfolioAllocationChart) { portfolioAllocationChart.destroy(); portfolioAllocationChart = null; }
            if (assetClassPerformanceChart) { assetClassPerformanceChart.destroy(); assetClassPerformanceChart = null; }
            if (cumulativeFlowsChart) { cumulativeFlowsChart.destroy(); cumulativeFlowsChart = null; } // Destroy cumulative flows chart
            if (shariahProductPerformanceChart) { shariahProductPerformanceChart.destroy(); shariahProductPerformanceChart = null; }
            if (clientPortfolioPerformanceChart) { clientPortfolioPerformanceChart.destroy(); clientPortfolioPerformanceChart = null; }
            if (clientCashFlowChart) { clientCashFlowChart.destroy(); clientCashFlowChart = null; }
            // New account-specific charts
            destroyAccountCharts();
        }
        
        // Function to destroy only account-specific charts
        function destroyAccountCharts() {
            if (accountPortfolioBreakdownChart) { accountPortfolioBreakdownChart.destroy(); accountPortfolioBreakdownChart = null; }
            if (accountPortfolioValueChangeChart) { accountPortfolioValueChangeChart.destroy(); accountPortfolioValueChangeChart = null; }
            if (accountAllocationComparisonChart) { accountAllocationComparisonChart.destroy(); accountAllocationComparisonChart = null; }
            if (accountAllocationMovementChart) { accountAllocationMovementChart.destroy(); accountAllocationMovementChart = null; }
            if (accountSectorAllocationChart) { accountSectorAllocationChart.destroy(); accountSectorAllocationChart = null; }
            if (accountHistoricalRiskChart) { accountHistoricalRiskChart.destroy(); accountHistoricalRiskChart = null; }
        }


        // Dark Mode Toggle
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const htmlElement = document.documentElement;

        // Function to get chart colors based on theme
        function getChartColors() {
            const isDarkMode = htmlElement.classList.contains('dark');
            return {
                isDarkMode: isDarkMode, // Added for direct use
                textColor: isDarkMode ? '#d1d5db' : '#374151', // gray-300 or gray-700
                gridColor: isDarkMode ? '#4b5563' : '#e5e7eb', // gray-600 or gray-200
                pieColors: ['#4299e1', '#63b3ed', '#8daddf', '#a0aec0', '#48bb78', '#f6ad55', '#e53e3e', '#805ad5'], // blue shades, green, orange, red, purple
                barColors: ['#48bb78', '#63b3ed', '#805ad5', '#f6ad55', '#e53e3e', '#a0aec0'], // Green, Blue, Purple, Orange, Red, Gray
                lineColor: '#3182ce',
                lineFillColor: 'rgba(49, 130, 206, 0.2)',
                shariahLineColor: '#48bb78',
                shariahLineFillColor: 'rgba(72, 187, 120, 0.2)',
                cashFlowPositive: 'rgba(75, 192, 192, 0.7)',
                cashFlowNegative: 'rgba(255, 99, 132, 0.7)',
                cashFlowBorderPositive: 'rgba(75, 192, 192, 1)',
                cashFlowBorderNegative: 'rgba(255, 99, 132, 1)',
                cumulativeFlowColors: [ // For the area chart lines/fills
                    'rgba(72, 187, 120, 0.7)', // Equities (Green)
                    'rgba(66, 153, 225, 0.7)', // Sukuk (Blue)
                    'rgba(128, 90, 213, 0.7)', // Mutual Funds & ETFs (Purple)
                    'rgba(246, 173, 85, 0.7)', // Real Estate/REITs (Orange)
                    'rgba(237, 100, 100, 0.7)', // Commodities (Red)
                    'rgba(100, 116, 139, 0.7)' // Private Equity/VC (Slate/Gray)
                ],
                 cumulativeFlowBorders: [ // For the area chart lines/fills
                    'rgb(72, 187, 120)', // Equities (Green)
                    'rgb(66, 153, 225)', // Sukuk (Blue)
                    'rgb(128, 90, 213)', // Mutual Funds & ETFs (Purple)
                    'rgb(246, 173, 85)', // Real Estate/REITs (Orange)
                    'rgb(237, 100, 100)', // Commodities (Red)
                    'rgb(100, 116, 139)' // Private Equity/VC (Slate/Gray)
                ],
                // Colors for risk gauge
                riskLow: '#48bb78',    // Green
                riskMedium: '#f6ad55', // Orange
                riskHigh: '#e53e3e'    // Red
            };
        }

        // Function to update chart colors
        function updateChartTheme(chart) {
            if (chart) {
                const colors = getChartColors();
                const scales = chart.options.scales || {};
                if(scales.x) {
                    scales.x.ticks.color = colors.textColor;
                    scales.x.grid.color = colors.gridColor;
                }
                 if(scales.y) {
                    scales.y.ticks.color = colors.textColor;
                    scales.y.grid.color = colors.gridColor;
                }
               
                if (chart.options.plugins && chart.options.plugins.legend) {
                    chart.options.plugins.legend.labels.color = colors.textColor;
                }
                // Specific updates for pie chart border
                if (chart.config.type === 'pie' && chart.data.datasets.length > 0) {
                    chart.data.datasets[0].borderColor = colors.isDarkMode ? '#2d3748' : '#ffffff';
                }
                // Specific updates for bar chart background and border
                if (chart.config.type === 'bar' && chart.data.datasets.length > 0) {
                    // This applies to fixed-color bar charts
                    if (chart.canvas.id !== 'clientCashFlowChart') { // Avoid changing colors for cash flow chart
                         chart.data.datasets[0].borderColor = colors.isDarkMode ? '#2d3748' : '#ffffff';
                    }
                }


                // Special handling for cash flow chart where colors depend on value
                if (chart.canvas.id === 'clientCashFlowChart' && chart.data.datasets.length > 0) {
                    chart.data.datasets[0].backgroundColor = chart.data.datasets[0].data.map(value => value >= 0 ? colors.cashFlowPositive : colors.cashFlowNegative);
                    chart.data.datasets[0].borderColor = chart.data.datasets[0].data.map(value => value >= 0 ? colors.cashFlowBorderPositive : colors.cashFlowBorderNegative);
                }

                chart.update();
            }
        }

        // Apply initial theme
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            htmlElement.classList.add('dark');
            darkModeToggle.checked = true;
        } else {
            htmlElement.classList.remove('dark');
            darkModeToggle.checked = false;
        }

        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                htmlElement.classList.add('dark');
                localStorage.theme = 'dark';
            } else {
                localStorage.theme = 'light';
                htmlElement.classList.remove('dark');
            }
            // Update all active charts with new theme colors
            if (portfolioAllocationChart) updateChartTheme(portfolioAllocationChart);
            if (assetClassPerformanceChart) updateChartTheme(assetClassPerformanceChart);
            if (cumulativeFlowsChart) updateChartTheme(cumulativeFlowsChart); // Update cumulative flows chart
            if (shariahProductPerformanceChart) updateChartTheme(shariahProductPerformanceChart);
            if (clientPortfolioPerformanceChart) updateChartTheme(clientPortfolioPerformanceChart);
            if (clientCashFlowChart) updateChartTheme(clientCashFlowChart);
            // New account-specific charts
            if (accountPortfolioBreakdownChart) updateChartTheme(accountPortfolioBreakdownChart);
            if (accountPortfolioValueChangeChart) updateChartTheme(accountPortfolioValueChangeChart);
            if (accountAllocationComparisonChart) updateChartTheme(accountAllocationComparisonChart);
            if (accountAllocationMovementChart) updateChartTheme(accountAllocationMovementChart);
            if (accountSectorAllocationChart) updateChartTheme(accountSectorAllocationChart);
            if (accountHistoricalRiskChart) updateChartTheme(accountHistoricalRiskChart);

            // Update risk gauge color
            updateRiskGaugeColor(currentAccountData ? currentAccountData.riskScore : 0);
        });

        // Navigation Logic
        const navLinks = document.querySelectorAll('.nav-link');
        const contentViews = document.querySelectorAll('.content-view');
        const pageTitle = document.getElementById('page-title');
        
        function activateNavLink(targetId) {
            navLinks.forEach(nav => {
                nav.classList.remove('active-nav', 'bg-blue-100', 'text-blue-700', 'dark:bg-blue-100', 'dark:text-blue-400');
                nav.classList.add('text-gray-700', 'hover:bg-blue-100', 'hover:text-blue-700', 'dark:text-gray-300');
            });

            const currentActiveLink = document.querySelector(`.nav-link[data-target="${targetId}"]`);
            if (currentActiveLink) {
                currentActiveLink.classList.add('active-nav', 'bg-blue-100', 'text-blue-700');
                currentActiveLink.classList.remove('text-gray-700', 'hover:bg-blue-100', 'hover:text-blue-700');
                if (htmlElement.classList.contains('dark')) {
                    currentActiveLink.classList.add('dark:bg-blue-100', 'dark:text-blue-400');
                    currentActiveLink.classList.remove('dark:text-gray-300');
                }
            }
        }

        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.dataset.target;

                // Destroy existing charts before switching views to prevent rendering issues
                destroyCharts();

                contentViews.forEach(view => view.classList.add('hidden'));

                const targetView = document.getElementById(targetId);
                if (targetView) {
                    targetView.classList.remove('hidden');
                    pageTitle.textContent = this.querySelector('span').textContent;
                    activateNavLink(targetId);

                    // Initialize charts for the newly active view
                    if (targetId === 'dashboard-view') {
                        initDashboardCharts();
                        renderTopClientsTable(); // Render top clients table for dashboard
                    }
                    if (targetId === 'clients-list-view') {
                        renderClientsList();
                    }
                }

                if (targetId === 'clients-list-view') {
                    document.getElementById('client-360-view').classList.add('hidden');
                    document.getElementById('account-dashboard-view').classList.add('hidden'); // Hide account dashboard
                }
            });
        });

        // Function to show Clients List and hide Client 360 View and Account Dashboard View
        function showClientsList() {
            destroyCharts(); // Destroy charts when moving back
            document.getElementById('client-360-view').classList.add('hidden');
            document.getElementById('account-dashboard-view').classList.add('hidden');
            document.getElementById('clients-list-view').classList.remove('hidden');
            pageTitle.textContent = "Clients";
            activateNavLink('clients-list-view');
            renderClientsList(); // Re-render client list to ensure state is correct
        }

        // Function to show Client 360 View from Account Dashboard
        function showClient360FromAccount() {
            destroyCharts(); // Destroy account dashboard charts
            document.getElementById('account-dashboard-view').classList.add('hidden');
            document.getElementById('client-360-view').classList.remove('hidden');
            // Re-activate the correct client 360 tab
            const overviewTabBtn = document.querySelector('.tab-button[data-tab="overview"]');
            if (overviewTabBtn) overviewTabBtn.click(); // Simulate click to re-initialize
            pageTitle.textContent = clients[currentClientId].name; // Restore client name in header
        }

        // Client 360 View Tab Logic
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                tabButtons.forEach(btn => btn.classList.remove('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400'));
                tabButtons.forEach(btn => btn.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'font-medium', 'text-xs', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500'));

                tabContents.forEach(content => content.classList.add('hidden'));

                this.classList.add('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400');
                this.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500');

                document.getElementById(`${this.dataset.tab}-tab-content`).classList.remove('hidden');

                // Initialize charts if portfolio tab is active
                if (this.dataset.tab === 'portfolio') {
                    initClientPortfolioCharts();
                } else if (this.dataset.tab === 'goals') {
                    // When Goals & Advisory is clicked, render the products in the advisory view
                    renderAdvisoryProducts();
                }
                else {
                    // Destroy client portfolio charts if switching away
                    if (clientPortfolioPerformanceChart) { clientPortfolioPerformanceChart.destroy(); clientPortfolioPerformanceChart = null; }
                    if (clientCashFlowChart) { clientCashFlowChart.destroy(); clientCashFlowChart = null; }
                }
            });
        });

        // Account Dashboard Tab Logic
        const accountTabButtons = document.querySelectorAll('.account-tab-button');
        const accountTabContents = document.querySelectorAll('.account-tab-content');
        let currentAccountData = null; // To hold the data of the currently displayed account

        accountTabButtons.forEach(button => {
            button.addEventListener('click', function() {
                accountTabButtons.forEach(btn => btn.classList.remove('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400'));
                accountTabButtons.forEach(btn => btn.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'font-medium', 'text-xs', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500'));

                accountTabContents.forEach(content => content.classList.add('hidden'));

                this.classList.add('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400');
                this.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500');

                const targetTabContent = document.getElementById(`${this.dataset.tab}-tab-content`);
                if (targetTabContent) {
                    targetTabContent.classList.remove('hidden');
                }

                // Initialize/update charts and content based on the active account tab
                destroyAccountCharts(); // Destroy all account charts before initializing new ones
                if (currentAccountData) {
                    switch (this.dataset.tab) {
                        case 'portfolio-overview':
                            initAccountPortfolioCharts(currentAccountData);
                            populateHoldingsTables(currentAccountData.topHoldings, currentAccountData.bottomHoldings);
                            break;
                        case 'account-summary':
                            populateAccountSummary(currentAccountData);
                            break;
                        case 'risk-alerts':
                            initAccountRiskCharts(currentAccountData);
                            populateRiskAlerts(currentAccountData);
                            break;
                        case 'cash-liquidity':
                            populateCashLiquidity(currentAccountData);
                            populateCashInflowsTable(currentAccountData);
                            break;
                        case 'recent-transactions':
                            populateRecentTransactions(currentAccountData);
                            break;
                        case 'account-documents':
                            populateAccountDocuments(currentAccountData);
                            break;
                    }
                }
            });
        });

        // Function to display client details in 360 view
        function displayClient360(clientId) {
            currentClientId = clientId; // Set current client ID
            const client = clients[clientId];
            if (client) {
                document.getElementById('client-name-display').textContent = client.name;
                document.getElementById('client-aum-display').textContent = `AUM: $${client.aum.toLocaleString()}`;
                document.getElementById('client-rm-display').textContent = `RM: ${client.rm}`;
                document.getElementById('client-email-display').textContent = client.email;
                document.getElementById('client-phone-display').textContent = client.phone;
                document.getElementById('client-risk-display').textContent = client.risk;
                document.getElementById('client-goals-display').textContent = client.goals;
                document.getElementById('client-assets-display').textContent = client.assets.toLocaleString();
                document.getElementById('client-liabilities-display').textContent = client.liabilities.toLocaleString();
                document.getElementById('client-networth-display').textContent = client.netWorth.toLocaleString();

                destroyCharts(); // Destroy dashboard/product charts

                contentViews.forEach(view => view.classList.add('hidden'));
                document.getElementById('client-360-view').classList.remove('hidden');
                pageTitle.textContent = client.name;
                activateNavLink('clients-list-view'); // Highlight Clients in sidebar

                // Reset to overview tab by default and initialize its charts
                tabButtons.forEach(btn => btn.classList.remove('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400'));
                tabButtons.forEach(btn => btn.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'font-medium', 'text-xs', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500'));
                
                const overviewTabBtn = document.querySelector('.tab-button[data-tab="overview"]');
                const overviewTabContent = document.getElementById('overview-tab-content');
                
                // Hide all tab contents first
                tabContents.forEach(content => content.classList.add('hidden'));

                if (overviewTabBtn && overviewTabContent) {
                    overviewTabBtn.classList.add('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400');
                    overviewTabBtn.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500');
                    overviewTabContent.classList.remove('hidden');
                }

                // If user lands directly on a client, no portfolio charts are immediately initialized unless the tab is clicked.
            }
        }

        // Function to display specific account dashboard
        function displayAccountDashboard(clientId, accountId) {
            currentClientId = clientId;
            currentAccountId = accountId;
            const client = clients[clientId];
            const account = client.accounts.find(acc => acc.accountId === accountId);

            if (client && account) {
                currentAccountData = account; // Store current account data globally

                document.getElementById('account-name-display').textContent = account.accountType;
                document.getElementById('account-aum-display').textContent = `AUM: $${account.aum.toLocaleString()}`;
                document.getElementById('account-type-display').textContent = `Type: ${account.accountType}`;

                destroyCharts(); // Destroy all other charts

                contentViews.forEach(view => view.classList.add('hidden'));
                document.getElementById('account-dashboard-view').classList.remove('hidden');
                pageTitle.textContent = `${client.name} - ${account.accountType}`;
                activateNavLink('clients-list-view'); // Keep Clients highlighted

                // Reset to Portfolio Overview tab by default and initialize its charts/content
                accountTabButtons.forEach(btn => btn.classList.remove('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400'));
                accountTabButtons.forEach(btn => btn.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'font-medium', 'text-xs', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500'));
                
                const portfolioOverviewTabBtn = document.querySelector('.account-tab-button[data-tab="portfolio-overview"]');
                const portfolioOverviewTabContent = document.getElementById('portfolio-overview-tab-content');

                // Hide all account tab contents first
                 accountTabContents.forEach(content => content.classList.add('hidden'));

                if (portfolioOverviewTabBtn && portfolioOverviewTabContent) {
                    portfolioOverviewTabBtn.classList.add('active-tab', 'border-blue-500', 'text-blue-600', 'dark:border-blue-400', 'dark:text-blue-400');
                    portfolioOverviewTabBtn.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'dark:text-gray-400', 'dark:hover:text-gray-300', 'dark:hover:border-gray-500');
                    portfolioOverviewTabContent.classList.remove('hidden');
                    initAccountPortfolioCharts(account); // Initialize charts for the active account
                    populateHoldingsTables(account.topHoldings, account.bottomHoldings);
                }
            }
        }

        // --- Client List Rendering with Accounts ---
        const clientsTableContainer = document.getElementById('clients-table-container');

        function renderClientsList() {
            clientsTableContainer.innerHTML = ''; // Clear existing content

            for (const clientId in clients) {
                const client = clients[clientId];
                const clientRowHtml = `
                    <div class="bg-white dark:bg-gray-700 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 mb-3 overflow-hidden">
                        <div class="flex items-center justify-between p-4 cursor-pointer client-header" data-client-id="${client.id}">
                            <div class="flex items-center">
                                <i class="fas fa-plus-circle text-blue-500 mr-3 expand-icon"></i>
                                <a href="#" class="client-link text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-500 font-medium" data-client-id="${client.id}">${client.name}</a>
                            </div>
                            <div class="flex items-center space-x-4 text-xs text-gray-700 dark:text-gray-300">
                                <span>AUM: $${client.aum.toLocaleString()}</span>
                                <span>Risk: ${client.risk}</span>
                                <span>Last Contact: ${client.lastActivity || 'N/A'}</span>
                                <a href="#" class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-600">Edit</a>
                            </div>
                        </div>
                        <div id="client-accounts-${client.id}" class="hidden bg-gray-50 dark:bg-gray-800 p-4 border-t border-gray-200 dark:border-gray-600">
                             <div class="flex justify-between items-center mb-3">
                                <h5 class="text-md font-semibold text-gray-800 dark:text-gray-100">Client Accounts:</h5>
                                <button class="bg-blue-500 text-white px-3 py-1.5 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-sm text-xs">
                                    <i class="fas fa-plus mr-2"></i>Add Client Account
                                </button>
                            </div>
                            <div class="space-y-3">
                                ${client.accounts.map(account => `
                                    <div class="flex flex-wrap items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600 text-xs">
                                        <div class="flex-grow grid grid-cols-1 md:grid-cols-3 gap-2">
                                            <p class="text-gray-700 dark:text-gray-300"><strong class="text-gray-800 dark:text-gray-200">Type:</strong> ${account.accountType}</p>
                                            <p class="text-gray-700 dark:text-gray-300"><strong class="text-gray-800 dark:text-gray-200">Risk Score:</strong> ${account.riskScore}</p>
                                            <p class="text-gray-700 dark:text-gray-300"><strong class="text-gray-800 dark:text-gray-200">AUM:</strong> $${account.aum.toLocaleString()}</p>
                                            <p class="text-gray-700 dark:text-gray-300 md:col-span-3"><strong class="text-gray-800 dark:text-gray-200">Last Activity:</strong> ${account.lastActivity}</p>
                                        </div>
                                        <button class="view-account-btn mt-3 md:mt-0 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors duration-200 shadow-md text-xs"
                                                data-client-id="${client.id}" data-account-id="${account.accountId}">
                                            View Account
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                clientsTableContainer.insertAdjacentHTML('beforeend', clientRowHtml);
            }

            // Add event listeners for expand/collapse icons
            document.querySelectorAll('.client-header').forEach(header => {
                header.addEventListener('click', function(e) {
                     if (e.target.tagName === 'A' || e.target.parentElement.tagName === 'A') return; // Don't toggle if client name link is clicked
                    const clientId = this.dataset.clientId;
                    const accountsDiv = document.getElementById(`client-accounts-${clientId}`);
                    const icon = this.querySelector('.expand-icon');
                    if (accountsDiv.classList.contains('hidden')) {
                        accountsDiv.classList.remove('hidden');
                        icon.classList.remove('fa-plus-circle');
                        icon.classList.add('fa-minus-circle');
                    } else {
                        accountsDiv.classList.add('hidden');
                        icon.classList.remove('fa-minus-circle');
                        icon.classList.add('fa-plus-circle');
                    }
                });
            });

            // Add event listeners for "View Account" buttons
            document.querySelectorAll('.view-account-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const clientId = this.dataset.clientId;
                    const accountId = this.dataset.accountId;
                    displayAccountDashboard(clientId, accountId);
                });
            });

             // Event listeners for client links in the list (for client 360 view)
            document.querySelectorAll('.client-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault(); // Prevent default link behavior
                    const clientId = this.dataset.clientId;
                    displayClient360(clientId);
                });
            });
        }


        // Initialize Dashboard Charts
        function initDashboardCharts() {
            const colors = getChartColors();

            // Portfolio Allocation Pie Chart
            const ctxPortfolio = document.getElementById('portfolioAllocationChart').getContext('2d');
            portfolioAllocationChart = new Chart(ctxPortfolio, {
                type: 'pie',
                data: {
                    labels: ['Equities', 'Bonds','Gilts', 'Alternatives', 'Cash', 'Mutual Funds'],
                    datasets: [{
                        data: [35, 20, 5, 15, 10, 15], // Adjusted data for Mutual Funds
                        backgroundColor: colors.pieColors,
                        borderColor: colors.isDarkMode ? '#2d3748' : '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: colors.textColor
                            }
                        },
                        title: {
                            display: false
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true
                    }
                }
            });

            // Portfolio Allocation Filter Dropdown Logic (Placeholder)
            const portfolioAllocationFilter = document.getElementById('portfolio-allocation-filter');
            portfolioAllocationFilter.addEventListener('change', function() {
                const selectedFilter = this.value;
                console.log('Portfolio Allocation Filter selected:', selectedFilter);
            });


            // Asset Class Performance Line Chart
            const ctxAsset = document.getElementById('assetClassPerformanceChart').getContext('2d');
            assetClassPerformanceChart = new Chart(ctxAsset, {
                type: 'line',
                data: {
                    labels: ['2019', '2020', '2021', '2022', '2023'],
                    datasets: [
                        {
                            label: 'Equities',
                            data: [8, 15, 12, 18, 20],
                            borderColor: '#48bb78', // Green
                            backgroundColor: '#48bb78',
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'Mutual Funds',
                            data: [6, 10, 8, 12, 14],
                            borderColor: '#3b82f6', // Blue
                            backgroundColor: '#3b82f6',
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'Bonds',
                            data: [3, 4, 3.5, 5, 4.5],
                            borderColor: '#f59e0b', // Amber
                            backgroundColor: '#f59e0b',
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'Gilts',
                            data: [2.5, 3, 2.8, 4, 3.8],
                            borderColor: '#a855f7', // Purple
                            backgroundColor: '#a855f7',
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'Alternatives',
                            data: [5, 7, 9, 6, 8],
                            borderColor: '#ef4444', // Red
                            backgroundColor: '#ef4444',
                            fill: false,
                            tension: 0.4
                        },
                        {
                            label: 'Cash',
                            data: [1, 1.2, 1.1, 1.5, 1.8],
                            borderColor: '#6b7280', // Gray
                            backgroundColor: '#6b7280',
                            fill: false,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                             labels: {
                                color: colors.textColor
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                        },
                        title: {
                            display: false,
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: colors.textColor },
                            grid: { color: colors.gridColor }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: colors.textColor,
                                callback: function(value) { return value + '%'; }
                            },
                            grid: { color: colors.gridColor }
                        }
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });
        }

        // Initialize Client Portfolio Charts (for Client 360 view, not account specific)
        function initClientPortfolioCharts() {
            const colors = getChartColors();

            // Client Portfolio Performance Line Chart
            const ctxClientPortfolio = document.getElementById('clientPortfolioPerformanceChart').getContext('2d');
            clientPortfolioPerformanceChart = new Chart(ctxClientPortfolio, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Portfolio Value (USD)',
                        data: [5000000, 5100000, 5050000, 5200000, 5300000, 5350000],
                        borderColor: colors.lineColor,
                        backgroundColor: colors.lineFillColor,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: colors.textColor },
                            grid: { color: colors.gridColor }
                        },
                        y: {
                            ticks: { color: colors.textColor, callback: function(value) { return '$' + value.toLocaleString(); } },
                            grid: { color: colors.gridColor }
                        }
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });

            // Client Cash Flow Bar Chart
            const ctxClientCashFlow = document.getElementById('clientCashFlowChart').getContext('2d');
            clientCashFlowChart = new Chart(ctxClientCashFlow, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Net Cash Flow (USD)',
                        data: [10000, -5000, 15000, 2000, 8000, -3000],
                        backgroundColor: [
                            colors.cashFlowPositive, colors.cashFlowNegative, colors.cashFlowPositive,
                            colors.cashFlowPositive, colors.cashFlowPositive, colors.cashFlowNegative
                        ],
                        borderColor: [
                            colors.cashFlowBorderPositive, colors.cashFlowBorderNegative, colors.cashFlowBorderPositive,
                            colors.cashFlowBorderPositive, colors.cashFlowBorderPositive, colors.cashFlowBorderNegative
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: colors.textColor },
                            grid: { color: colors.gridColor }
                        },
                        y: {
                            ticks: { color: colors.textColor, callback: function(value) { return '$' + value.toLocaleString(); } },
                            grid: { color: colors.gridColor }
                        }
                    },
                    animation: {
                        duration: 1000
                    }
                }
            });
        }

        // --- New: Account Dashboard Charts ---
        function initAccountPortfolioCharts(accountData) {
            const colors = getChartColors();

            // Portfolio Breakdown by Asset Class (Pie Chart)
            const ctxBreakdown = document.getElementById('accountPortfolioBreakdownChart').getContext('2d');
            accountPortfolioBreakdownChart = new Chart(ctxBreakdown, {
                type: 'pie',
                data: {
                    labels: accountData.portfolioBreakdown.labels,
                    datasets: [{
                        data: accountData.portfolioBreakdown.data,
                        backgroundColor: colors.pieColors,
                        borderColor: colors.isDarkMode ? '#2d3748' : '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: colors.textColor
                            }
                        },
                        title: { display: false }
                    },
                    animation: { animateRotate: true, animateScale: true }
                }
            });

             // Change in Portfolio Value (Line Chart)
            const ctxValueChange = document.getElementById('accountPortfolioValueChangeChart').getContext('2d');
            const initialPeriod = 'YTD';
            accountPortfolioValueChangeChart = new Chart(ctxValueChange, {
                type: 'line',
                data: {
                    labels: Array.from({ length: accountData.portfolioValueChange[initialPeriod].length }, (_, i) => i + 1),
                    datasets: [{
                        label: 'Portfolio Value',
                        data: accountData.portfolioValueChange[initialPeriod],
                        borderColor: colors.lineColor,
                        backgroundColor: colors.lineFillColor,
                        tension: 0.3,
                        fill: true,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { display: false },
                        y: { ticks: { color: colors.textColor, callback: (value) => `$${(value / 1000000).toFixed(1)}M`}, grid: { color: colors.gridColor } }
                    },
                    animation: { duration: 1000 }
                }
            });

            // Event listener for time filters
            document.getElementById('portfolio-value-time-filters').addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const period = e.target.dataset.period;
                    document.querySelectorAll('#portfolio-value-time-filters .time-filter-button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');

                    accountPortfolioValueChangeChart.data.datasets[0].data = accountData.portfolioValueChange[period];
                    accountPortfolioValueChangeChart.data.labels = Array.from({ length: accountData.portfolioValueChange[period].length }, (_, i) => i + 1);
                    accountPortfolioValueChangeChart.update();
                }
            });

            // Allocation Movement Over Time (Multi-Line Chart)
            const ctxAllocationMovement = document.getElementById('accountAllocationMovementChart').getContext('2d');
            accountAllocationMovementChart = new Chart(ctxAllocationMovement, {
                type: 'line',
                data: {
                    labels: accountData.allocationMovement.labels,
                    datasets: [
                        {
                            label: 'Equities',
                            data: accountData.allocationMovement.equity,
                            borderColor: colors.barColors[0], // Green
                            fill: false,
                            tension: 0.3
                        },
                        {
                            label: 'Fixed Income',
                            data: accountData.allocationMovement.fixedIncome,
                            borderColor: colors.barColors[1], // Blue
                            fill: false,
                            tension: 0.3
                        }
                    ]
                },
                 options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { position: 'top', labels: { color: colors.textColor } } },
                    scales: {
                        x: { ticks: { color: colors.textColor }, grid: { color: colors.gridColor } },
                        y: { beginAtZero: true, ticks: { color: colors.textColor, callback: (value) => `${value}%` }, grid: { color: colors.gridColor } }
                    },
                    animation: { duration: 1000 }
                }
            });
            
            // Sector Allocation (Bar Chart)
            const ctxSectorAllocation = document.getElementById('accountSectorAllocationChart').getContext('2d');
            accountSectorAllocationChart = new Chart(ctxSectorAllocation, {
                type: 'bar',
                data: {
                    labels: accountData.sectorAllocation.labels,
                    datasets: [{
                        label: 'Allocation (%)',
                        data: accountData.sectorAllocation.data,
                        backgroundColor: colors.pieColors, // Reusing pie colors for diverse bars
                        borderColor: colors.isDarkMode ? '#2d3748' : '#ffffff',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // Horizontal bar chart
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { beginAtZero: true, ticks: { color: colors.textColor, callback: function(value) { return value + '%'; } }, grid: { color: colors.gridColor } },
                        y: { ticks: { color: colors.textColor }, grid: { color: colors.gridColor } }
                    },
                    animation: { duration: 1000 }
                }
            });
        }

        function populateHoldingsTables(topHoldings, bottomHoldings) {
            const topHoldingsBody = document.getElementById('top-holdings-table-body');
            const bottomHoldingsBody = document.getElementById('bottom-holdings-table-body');

            topHoldingsBody.innerHTML = '';
            bottomHoldingsBody.innerHTML = '';

            const actionButtonsHtml = `
                <div class="flex gap-2">
                     <button class="bg-green-500 text-white px-3 py-1 rounded-md text-xs hover:bg-green-600 transition-colors duration-200"> Buy</button>
                     <button class="bg-red-500 text-white px-3 py-1 rounded-md text-xs hover:bg-red-600 transition-colors duration-200"> Sell</button>
                </div>
            `;

            topHoldings.forEach(holding => {
                const row = `
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${holding.name}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${holding.weight.toFixed(1)}%</td>
                        <td class="px-4 py-3 whitespace-nowrap ${holding.return >= 0 ? 'text-green-600' : 'text-red-600'}">${holding.return >= 0 ? '+' : ''}${holding.return.toFixed(1)}%</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${holding.currency}</td>
                        <td class="px-4 py-3 whitespace-nowrap">${actionButtonsHtml}</td>
                    </tr>
                `;
                topHoldingsBody.insertAdjacentHTML('beforeend', row);
            });

            bottomHoldings.forEach(holding => {
                const row = `
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${holding.name}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${holding.weight.toFixed(1)}%</td>
                        <td class="px-4 py-3 whitespace-nowrap ${holding.return >= 0 ? 'text-green-600' : 'text-red-600'}">${holding.return >= 0 ? '+' : ''}${holding.return.toFixed(1)}%</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${holding.currency}</td>
                        <td class="px-4 py-3 whitespace-nowrap">${actionButtonsHtml}</td>
                    </tr>
                `;
                bottomHoldingsBody.insertAdjacentHTML('beforeend', row);
            });
        }

        function populateAccountSummary(accountData) {
            document.getElementById('summary-creation-date').textContent = accountData.summary.creationDate;
            document.getElementById('summary-mandate-type').textContent = accountData.summary.mandateType;
            document.getElementById('summary-custodian').textContent = accountData.summary.custodianName;
            document.getElementById('summary-compliance-status').textContent = accountData.summary.complianceStatus;
            document.getElementById('summary-compliance-status').className = `font-semibold ${accountData.summary.complianceStatus.includes('Compliant') ? 'text-green-600' : 'text-red-600'}`;
            document.getElementById('summary-investment-guidelines').textContent = accountData.summary.investmentGuidelines;
            document.getElementById('summary-currency').textContent = accountData.summary.currencyUsed;
        }

        function updateRiskGauge(score) {
            const colors = getChartColors();
            const arc = document.getElementById('risk-gauge-value-arc');
            const needle = document.getElementById('risk-gauge-needle');
            const label = document.getElementById('risk-gauge-label');

            // Calculate rotation for needle (0-100 score maps to 0-180 degrees)
            const rotation = (score / 100) * 180 - 90; // -90 to start from left, 90 to end at right
            needle.style.transform = `translateX(-50%) rotate(${rotation}deg)`;

            // Determine color based on score
            let color;
            if (score < 40) {
                color = colors.riskLow;
            } else if (score < 75) {
                color = colors.riskMedium;
            } else {
                color = colors.riskHigh;
            }

            // Update arc and needle color
            arc.style.borderColor = `${color} transparent transparent transparent`;
            needle.style.backgroundColor = color;
            document.querySelector('.gauge-chart-center-dot').style.backgroundColor = color;

            label.textContent = `Score: ${score}`;
            label.style.color = colors.textColor; // Ensure label text color adapts
        }

        function updateRiskGaugeColor(score) {
            const colors = getChartColors();
            const arc = document.getElementById('risk-gauge-value-arc');
            const needle = document.getElementById('risk-gauge-needle');
            const centerDot = document.querySelector('.gauge-chart-center-dot');
            const label = document.getElementById('risk-gauge-label');

            let color;
            if (score < 40) {
                color = colors.riskLow;
            } else if (score < 75) {
                color = colors.riskMedium;
            } else {
                color = colors.riskHigh;
            }

            arc.style.borderColor = `${color} transparent transparent transparent`;
            needle.style.backgroundColor = color;
            centerDot.style.backgroundColor = color;
            label.style.color = colors.textColor; // Ensure label text color adapts
            document.getElementById('risk-gauge-arc').style.borderColor = colors.isDarkMode ? '#4a5568' : '#e2e8f0'; // Base arc color
        }


        function initAccountRiskCharts(accountData) {
            const colors = getChartColors();

            // Current Risk Score Gauge Chart
            updateRiskGauge(accountData.riskScore);
            updateRiskGaugeColor(accountData.riskScore); // Initial color update

            // Historical Risk Score Trend (Line chart)
            const ctxHistoricalRisk = document.getElementById('accountHistoricalRiskChart').getContext('2d');
            accountHistoricalRiskChart = new Chart(ctxHistoricalRisk, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'], // Mock labels
                    datasets: [{
                        label: 'Risk Score',
                        data: accountData.historicalRiskScore,
                        borderColor: colors.lineColor,
                        backgroundColor: colors.lineFillColor,
                        tension: 0.3,
                        fill: false,
                        pointRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: colors.textColor }, grid: { color: colors.gridColor } },
                        y: { beginAtZero: true, max: 100, ticks: { color: colors.textColor }, grid: { color: colors.gridColor } }
                    },
                    animation: { duration: 1000 }
                }
            });
        }

        function populateRiskAlerts(accountData) {
            const alertsList = document.getElementById('risk-alerts-list');
            alertsList.innerHTML = '';
            if (accountData.alerts && accountData.alerts.length > 0) {
                accountData.alerts.forEach(alert => {
                    let textColorClass = 'text-gray-700 dark:text-gray-300';
                    if (alert.severity === 'High') textColorClass = 'text-red-600 dark:text-red-400';
                    else if (alert.severity === 'Medium') textColorClass = 'text-yellow-600 dark:text-yellow-400';

                    const listItem = `
                        <li class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg flex items-center">
                            <i class="fas fa-exclamation-circle mr-2 ${textColorClass}"></i>
                            <span class="${textColorClass} font-medium">${alert.type}:</span>
                            <span class="ml-2 text-gray-600 dark:text-gray-400">${alert.description}</span>
                        </li>
                    `;
                    alertsList.insertAdjacentHTML('beforeend', listItem);
                });
            } else {
                alertsList.innerHTML = '<li class="text-gray-600 dark:text-gray-400">No active alerts for this account.</li>';
            }
        }

        function populateCashLiquidity(accountData) {
            document.getElementById('cash-available').textContent = `$${accountData.cashLiquidity.availableCash.toLocaleString()}`;
            document.getElementById('cash-inflows').textContent = accountData.cashLiquidity.pendingInflows;
            document.getElementById('cash-outflows').textContent = accountData.cashLiquidity.pendingOutflows;
            document.getElementById('cash-recommended').textContent = `$${accountData.cashLiquidity.recommendedCashBuffer.toLocaleString()}`;
            document.getElementById('cash-redemptions').textContent = accountData.cashLiquidity.upcomingRedemptions;
        }

        function populateCashInflowsTable(accountData) {
             const tableBody = document.getElementById('upcoming-inflows-table-body');
             tableBody.innerHTML = ''; // Clear existing data

             const inflows = accountData.cashLiquidity.upcomingInflows || [];

             if (inflows.length === 0) {
                 tableBody.innerHTML = `<tr><td colspan="5" class="text-center py-4 text-gray-500 dark:text-gray-400">No upcoming inflows for this account.</td></tr>`;
                 return;
             }

             inflows.forEach(inflow => {
                 const row = `
                     <tr>
                         <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${inflow.instrument}</td>
                         <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${inflow.type}</td>
                         <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${inflow.amount.toLocaleString()}</td>
                         <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${inflow.currency}</td>
                         <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${inflow.date}</td>
                     </tr>
                 `;
                 tableBody.insertAdjacentHTML('beforeend', row);
             });
        }
        
        // Add event listener for cash inflow time filters
        document.getElementById('cash-inflows-time-filters').addEventListener('click', (e) => {
             if (e.target.tagName === 'BUTTON') {
                const period = e.target.dataset.period;
                document.querySelectorAll('#cash-inflows-time-filters .time-filter-button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                // Placeholder for filtering logic
                console.log(`Filtering cash inflows for period: ${period}`);
                // Re-populate table based on filter (not implemented with current dummy data)
                populateCashInflowsTable(currentAccountData);
             }
        });


        function populateRecentTransactions(accountData) {
            const transactionsTableBody = document.getElementById('transactions-table-body');
            transactionsTableBody.innerHTML = '';
            accountData.transactions.forEach(transaction => {
                const statusColorClass = transaction.status === 'Completed' ? 'text-green-600' : 'text-yellow-600';
                const row = `
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${transaction.date}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${transaction.security}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${transaction.type}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${transaction.quantity}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$${transaction.value.toLocaleString()}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${transaction.currency}</td>
                        <td class="px-4 py-3 whitespace-nowrap ${statusColorClass}">${transaction.status}</td>
                    </tr>
                `;
                transactionsTableBody.insertAdjacentHTML('beforeend', row);
            });
        }

        function populateAccountDocuments(accountData) {
            const documentsList = document.getElementById('account-documents-list');
            documentsList.innerHTML = '';
            if (accountData.documents && accountData.documents.length > 0) {
                accountData.documents.forEach(doc => {
                    let iconClass = 'fas fa-file';
                    let iconColorClass = 'text-gray-500';
                    if (doc.name.endsWith('.pdf')) { iconClass = 'fas fa-file-pdf'; iconColorClass = 'text-red-500'; }
                    else if (doc.name.endsWith('.xlsx')) { iconClass = 'fas fa-file-excel'; iconColorClass = 'text-green-600'; }
                    else if (doc.name.endsWith('.docx')) { iconClass = 'fas fa-file-word'; iconColorClass = 'text-blue-500'; }

                    const listItem = `
                        <li class="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg flex items-center justify-between text-gray-900 dark:text-gray-200 text-xs">
                            <span><i class="${iconClass} mr-2 ${iconColorClass}"></i>${doc.name}</span>
                            <span class="text-[11px] text-gray-500 dark:text-gray-400">Uploaded: ${doc.date}</span>
                            <a href="#" class="text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-500 text-[11px] ml-auto">${doc.action}</a>
                        </li>
                    `;
                    documentsList.insertAdjacentHTML('beforeend', listItem);
                });
            } else {
                documentsList.innerHTML = '<li class="text-gray-600 dark:text-gray-400">No documents available for this account.</li>';
            }
        }


        // Upcoming Activities/Events Toggle Logic
        const activitiesToggle = document.getElementById('activities-toggle');
        const eventsToggle = document.getElementById('events-toggle');
        const activitiesContent = document.getElementById('activities-content');
        const eventsContent = document.getElementById('events-content');

        function toggleScheduleView(view) {
            if (view === 'activities') {
                activitiesContent.classList.remove('hidden');
                eventsContent.classList.add('hidden');
                activitiesToggle.classList.add('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                activitiesToggle.classList.remove('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300', 'hover:bg-gray-300', 'dark:hover:bg-gray-500');
                eventsToggle.classList.remove('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                eventsToggle.classList.add('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300', 'hover:bg-gray-300', 'dark:hover:bg-gray-500');
            } else if (view === 'events') {
                activitiesContent.classList.add('hidden');
                eventsContent.classList.remove('hidden');
                eventsToggle.classList.add('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                eventsToggle.classList.remove('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300', 'hover:bg-gray-300', 'dark:hover:bg-gray-500');
                activitiesToggle.classList.remove('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                activitiesToggle.classList.add('bg-gray-200', 'text-gray-700', 'dark:bg-gray-700', 'dark:text-gray-300', 'hover:bg-gray-300', 'dark:hover:bg-gray-500');
            }
        }

        activitiesToggle.addEventListener('click', () => toggleScheduleView('activities'));
        eventsToggle.addEventListener('click', () => toggleScheduleView('events'));


        // Dummy Product Data
        const products = [
            // Equities
            { name: "Al Rajhi Equity Fund", category: "Equities", riskProfile: "Aggressive", return: 12.6, currency: "SAR", isShariah: true, description: "Diversified exposure to top halal stocks listed on Tadawul.", historicalReturns: [10, 11, 12, 11.5, 12.6, 13] },
            { name: "Global Tech Leaders", category: "Equities", riskProfile: "Aggressive", return: 18.5, currency: "USD", isShariah: false, description: "Invests in leading non-compliant technology giants like FAANG.", historicalReturns: [15, 16, 17, 18, 18.5, 19] },
            { name: "Dubai Islamic Equities", category: "Equities", riskProfile: "Moderate", return: 10.1, currency: "AED", isShariah: true, description: "Invests in Shari'ah-compliant companies on DFM and ADX.", historicalReturns: [8, 9, 10, 9.5, 10.1, 11] },
            { name: "Global Islamic Tech", category: "Equities", riskProfile: "Aggressive", return: 15.2, currency: "USD", isShariah: true, description: "Invests globally in Shari'ah-compliant technology companies.", historicalReturns: [12, 13, 14, 13.5, 15.2, 16] },
            // Sukuk
            { name: "Emirates Ijarah Sukuk", category: "Sukuk", riskProfile: "Conservative", return: 4.2, currency: "AED", isShariah: true, description: "Asset-backed sukuk issued by UAE government-linked entities.", historicalReturns: [3.5, 3.8, 4.0, 4.1, 4.2, 4.3] },
            { name: "Global High-Yield Bond", category: "Sukuk", riskProfile: "Aggressive", return: 7.1, currency: "USD", isShariah: false, description: "Conventional high-yield corporate bonds for higher risk appetite.", historicalReturns: [6, 6.5, 6.8, 7.0, 7.1, 7.2] },
            { name: "Saudi Sovereign Sukuk", category: "Sukuk", riskProfile: "Conservative", return: 3.8, currency: "SAR", isShariah: true, description: "Government-issued sukuk for stable, Shari'ah-compliant income.", historicalReturns: [3.0, 3.2, 3.5, 3.7, 3.8, 3.9] },
             // Mutual Funds & ETFs
            { name: "KFH Islamic Balanced Fund", category: "Mutual Funds & ETFs", riskProfile: "Moderate", return: 7.8, currency: "KWD", isShariah: true, description: "Combines income and growth with Shariah oversight board.", historicalReturns: [6.5, 7.0, 7.5, 7.7, 7.8, 8.0] },
            { name: "Al-Ahli GCC Growth Fund", category: "Mutual Funds & ETFs", riskProfile: "Moderate", return: 9.1, currency: "SAR", isShariah: true, description: "Invests in growth-oriented GCC Shari'ah-compliant companies.", historicalReturns: [8.0, 8.5, 8.9, 9.0, 9.1, 9.3] },
            // Real Estate/REITs
            { name: "Jadwa REIT Saudi", category: "Real Estate/REITs", riskProfile: "Conservative", return: 5.3, currency: "SAR", isShariah: true, description: "Invests in halal commercial properties across KSA.", historicalReturns: [4.5, 4.8, 5.0, 5.1, 5.3, 5.4] },
            { name: "Al Safwa Properties Fund", category: "Real Estate/REITs", riskProfile: "Moderate", return: 6.5, currency: "AED", isShariah: true, description: "Direct investments in Shari'ah-compliant real estate projects in Dubai.", historicalReturns: [5.8, 6.0, 6.2, 6.3, 6.5, 6.7] },
        ];


        // Function to render sparklines within product cards
        function renderSparkline(canvasId, data) {
            const colors = getChartColors();
            const ctx = document.getElementById(canvasId)?.getContext('2d');
            if (ctx) {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: data.length}, (_, i) => i + 1), // Simple labels for sparkline
                        datasets: [{
                            data: data,
                            borderColor: colors.shariahLineColor, // Consistent color
                            borderWidth: 1.5,
                            fill: false,
                            tension: 0.3,
                            pointRadius: 0 // No points
                        }]
                    },
                    options: {
                        responsive: false, // Keep static for sparklines
                        maintainAspectRatio: false,
                        elements: {
                            line: {
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: { display: false },
                            y: { display: false }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: { enabled: false }
                        },
                        layout: {
                            padding: {
                                left: 0,
                                right: 0,
                                top: 0,
                                bottom: 0
                            }
                        }
                    }
                });
            }
        }

        // --- Goals & Advisory Tab Logic ---
        const financialGoalsToggle = document.getElementById('financial-goals-toggle');
        const advisoryToggle = document.getElementById('advisory-toggle');
        const financialGoalsContent = document.getElementById('financial-goals-content');
        const advisoryContent = document.getElementById('advisory-content');
        const advisoryProductCardsGrid = document.getElementById('advisory-product-cards-grid');

        function toggleGoalsAdvisoryView(view) {
            if (view === 'goals') {
                financialGoalsContent.classList.remove('hidden');
                advisoryContent.classList.add('hidden');
                financialGoalsToggle.classList.add('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                financialGoalsToggle.classList.remove('text-gray-700', 'dark:text-gray-300');
                advisoryToggle.classList.remove('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                advisoryToggle.classList.add('text-gray-700', 'dark:text-gray-300');
            } else { // 'advisory'
                financialGoalsContent.classList.add('hidden');
                advisoryContent.classList.remove('hidden');
                advisoryToggle.classList.add('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                advisoryToggle.classList.remove('text-gray-700', 'dark:text-gray-300');
                financialGoalsToggle.classList.remove('bg-blue-500', 'text-white', 'dark:bg-blue-600', 'dark:text-gray-100');
                financialGoalsToggle.classList.add('text-gray-700', 'dark:text-gray-300');
                renderAdvisoryProducts();
            }
        }

        financialGoalsToggle.addEventListener('click', () => toggleGoalsAdvisoryView('goals'));
        advisoryToggle.addEventListener('click', () => toggleGoalsAdvisoryView('advisory'));


        function renderAdvisoryProducts() {
            advisoryProductCardsGrid.innerHTML = '';
            let filteredProducts = [...products];

            // Filter by Category
            const selectedCategory = document.querySelector('#advisory-category-filters .filter-button.active')?.dataset.category || 'All';
            if (selectedCategory !== 'All') {
                filteredProducts = filteredProducts.filter(p => p.category === selectedCategory);
            }

            // Filter by Shariyah
            const selectedShariyah = document.querySelector('#advisory-shariyah-filters .filter-button.active')?.dataset.shariyah || 'all';
            if (selectedShariyah === 'yes') {
                filteredProducts = filteredProducts.filter(p => p.isShariah);
            } else if (selectedShariyah === 'no') {
                filteredProducts = filteredProducts.filter(p => !p.isShariah);
            }

             // Filter by Currency
            const selectedCurrency = document.querySelector('#advisory-currency-filters .filter-button.active')?.dataset.currency || 'All';
            if (selectedCurrency !== 'All') {
                filteredProducts = filteredProducts.filter(p => p.currency === selectedCurrency);
            }

            // Sort products
            const sortBy = document.getElementById('sort-by-advisory').value;
            const riskProfileMap = { 'Conservative': 1, 'Moderate': 2, 'Aggressive': 3 };

            if (sortBy === 'return-asc') {
                filteredProducts.sort((a, b) => a.return - b.return);
            } else if (sortBy === 'return-desc') {
                filteredProducts.sort((a, b) => b.return - a.return);
            } else if (sortBy === 'risk-con-agg') {
                filteredProducts.sort((a,b) => riskProfileMap[a.riskProfile] - riskProfileMap[b.riskProfile]);
            } else if (sortBy === 'risk-agg-con') {
                filteredProducts.sort((a,b) => riskProfileMap[b.riskProfile] - riskProfileMap[a.riskProfile]);
            }

            filteredProducts.forEach((product) => {
                const card = document.createElement('div');
                card.className = 'bg-white dark:bg-gray-700 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-600 relative product-card';
                card.innerHTML = `
                    <div class="absolute top-3 right-3 flex items-center space-x-3">
                         <span class="product-action-icon" title="Add to Basket">
                            <i class="fas fa-plus-circle text-lg"></i>
                         </span>
                         <a href="https://ujjwalpatilcred.github.io/Fund_Factsheet_sample/Fund%20Factsheet%20Sample%201.html" target="_blank" class="product-action-icon" title="Download Factsheet">
                            <i class="fas fa-download text-lg"></i>
                         </a>
                    </div>
                    <div class="content-area">
                        <h4 class="text-sm font-semibold text-blue-600 dark:text-blue-400 mb-1 pr-12">${product.name}</h4>
                        <p class="text-xs text-gray-600 dark:text-gray-400 mb-0.5"><strong>Asset Class:</strong> ${product.category}</p>
                         <p class="text-xs text-gray-600 dark:text-gray-400 mb-0.5"><strong>Risk Profile:</strong> ${product.riskProfile}</p>
                        <div class="flex items-center text-xs text-green-600 mb-2">
                             <span>1Y Return: +${product.return}%</span>
                        </div>
                        <p class="text-[11px] text-gray-700 dark:text-gray-300 leading-tight">${product.description}</p>
                    </div>
                `;
                advisoryProductCardsGrid.appendChild(card);
            });
        }
        
        // Event listeners for all advisory filter buttons
        document.querySelectorAll('#advisory-content .filter-button').forEach(button => {
            button.addEventListener('click', function() {
                // Get the parent container of the clicked button
                const parentContainer = this.parentElement;
                // Deactivate all buttons within that same container
                parentContainer.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active', 'bg-blue-500', 'text-white', 'dark:bg-blue-600'));
                // Activate the clicked button
                this.classList.add('active', 'bg-blue-500', 'text-white', 'dark:bg-blue-600');
                renderAdvisoryProducts();
            });
        });

        document.getElementById('sort-by-advisory').addEventListener('change', renderAdvisoryProducts);


        // Initialize dashboard view on load
        document.addEventListener('DOMContentLoaded', () => {
            const dashboardLink = document.querySelector('.nav-link[data-target="dashboard-view"]');
            if (dashboardLink) {
                dashboardLink.click(); 
            }
            toggleScheduleView('activities'); // Set default toggle view for dashboard
            renderClientsList(); // Initial render of clients list
        });

        // Clients Attention Modal Logic
        const clientsAttentionCard = document.getElementById('clients-attention-card');
        const clientsAttentionModal = document.getElementById('clients-attention-modal');
        const closeAttentionModalBtn = document.getElementById('close-attention-modal');

        clientsAttentionCard.addEventListener('click', () => {
            clientsAttentionModal.classList.remove('hidden');
        });

        closeAttentionModalBtn.addEventListener('click', () => {
            clientsAttentionModal.classList.add('hidden');
        });

        clientsAttentionModal.addEventListener('click', (e) => {
            if (e.target === clientsAttentionModal) {
                clientsAttentionModal.classList.add('hidden');
            }
        });

        // Notification Panel Logic
        const notificationBell = document.getElementById('notification-bell');
        const notificationBadge = document.getElementById('notification-badge');
        const notificationPanel = document.getElementById('notification-panel');
        const closeNotificationPanelBtn = document.getElementById('close-notification-panel');

        notificationBadge.style.display = 'block'; 

        notificationBell.addEventListener('click', (e) => {
            e.stopPropagation(); 
            notificationPanel.classList.toggle('open');
            if (notificationPanel.classList.contains('open')) {
                notificationBadge.style.display = 'none'; 
            }
        });

        closeNotificationPanelBtn.addEventListener('click', () => {
            notificationPanel.classList.remove('open');
        });

        document.addEventListener('click', (e) => {
            if (!notificationPanel.contains(e.target) && !notificationBell.contains(e.target)) {
                notificationPanel.classList.remove('open');
            }
        });

        // Top Clients Table Sorting Logic
        function renderTopClientsTable() {
            const topClientsTableBody = document.getElementById('top-clients-table-body');
            topClientsTableBody.innerHTML = ''; // Clear existing rows

            // Sort data based on current sort key and direction
            const sortedData = [...dashboardTopClientsData].sort((a, b) => {
                let valA = a[currentTopClientsSortKey];
                let valB = b[currentTopClientsSortKey];

                if (typeof valA === 'string') {
                    valA = valA.toLowerCase();
                    valB = valB.toLowerCase();
                }

                if (valA < valB) return currentTopClientsSortDirection === 'asc' ? -1 : 1;
                if (valA > valB) return currentTopClientsSortDirection === 'asc' ? 1 : -1;
                return 0;
            });

            sortedData.forEach(client => {
                const row = `
                    <tr>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${client.clientName}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">$${(client.aum / 1000000).toFixed(0)}M</td>
                        <td class="px-4 py-3 whitespace-nowrap ${client.netFlows >= 0 ? 'text-green-600' : 'text-red-600'}">${client.netFlows >= 0 ? '+' : ''}${(client.netFlows / 1000000).toFixed(0)}M</td>
                        <td class="px-4 py-3 whitespace-nowrap ${client.performance >= 0 ? 'text-green-600' : 'text-red-600'}">${client.performance >= 0 ? '+' : ''}${client.performance.toFixed(1)}%</td>
                        <td class="px-4 py-3 whitespace-nowrap text-gray-700 dark:text-gray-300">${client.numAccounts}</td>
                    </tr>
                `;
                topClientsTableBody.insertAdjacentHTML('beforeend', row);
            });

            // Update sort icons
            document.querySelectorAll('#dashboard-view th[data-sort-key]').forEach(th => {
                const icon = th.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-sort', 'fa-sort-up', 'fa-sort-down');
                    if (th.dataset.sortKey === currentTopClientsSortKey) {
                        icon.classList.add(currentTopClientsSortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down');
                    } else {
                        icon.classList.add('fa-sort');
                    }
                }
            });
        }

        // Add event listeners for sorting headers
        document.querySelectorAll('#dashboard-view th[data-sort-key]').forEach(header => {
            header.addEventListener('click', function() {
                const sortKey = this.dataset.sortKey;
                if (currentTopClientsSortKey === sortKey) {
                    currentTopClientsSortDirection = currentTopClientsSortDirection === 'asc' ? 'desc' : 'asc';
                } else {
                    currentTopClientsSortKey = sortKey;
                    currentTopClientsSortDirection = 'asc'; // Default to ascending for new sort key
                }
                renderTopClientsTable();
            });
        });
    </script>
<script>
// This script block is intentionally left here to demonstrate the consolidation of chart logic
// into the main script for better maintainability, as per best practices.
// The charts are now initialized dynamically via the `initDashboardCharts` and other functions.
</script>
</body>
</html>
